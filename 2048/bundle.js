!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.equals=function(t){return t.x==this.x&&t.y==this.y},t.prototype.matches=function(t,e){return t==this.x&&e==this.y},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.add=function(t){this.x+=t.x,this.y+=t.y},t.zero=function(){return new t(0,0)},t.random=function(){return new t(Math.floor(4*Math.random()),Math.floor(4*Math.random()))},t.add=function(e,n){return new t(e.x+n.x,e.y+n.y)},t}(),o=[0,112,224,336],i=function(){function t(t,e){this.id=Math.random(),this.position=new r(t,e),this.value=Math.random()>=.9?2:1}return Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},enumerable:!1,configurable:!0}),t.prototype.draw=function(){var t=document.getElementById("root"),e=document.createElement("div");return e.classList.add("tile"),e.classList.add("tile-"+this.value),e.innerText=Math.pow(2,this.value).toString(),e.style.left=o[this.position.x]+"px",e.style.top=o[this.position.y]+"px",t.insertAdjacentElement("beforeend",e),this.element=e,this},t.prototype.update=function(t){var e=this;void 0===t&&(t=!1);return this.element.style.left=o[this.position.x]+"px",this.element.style.top=o[this.position.y]+"px",setTimeout((function(){e.element.className="tile tile-"+e.value,e.element.innerText=Math.pow(2,e.value).toString(),t&&e.remove()}),100),this},t.prototype.remove=function(){this.element.remove()},t.from=function(e){return new t(e.x,e.y)},t}();function a(t,e){var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(e==s.Up)for(var r=0;r<4;r++){for(var o=[],i=0;i<4;i++)o.push(t[r+4*i]);o=u(o);for(i=0;i<4;i++)n[r+4*i]=o[i]}else if(e==s.Left)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[4*r+i]);o=u(o);for(i=0;i<4;i++)n[4*r+i]=o[i]}else if(e==s.Down)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[r+4*(3-i)]);o=u(o);for(i=0;i<4;i++)n[r+4*(3-i)]=o[i]}else if(e==s.Right)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[4*r+(3-i)]);o=u(o);for(i=0;i<4;i++)n[4*r+(3-i)]=o[i]}return n}function u(t){var e=-1,n=0,r=[0,0,0,0];return t.forEach((function(t){0!=t&&(1==e?(e=t,r[n]=t,n++):e==t?(r[n-1]=2*e,e=-1):(e=t,r[n]=t,n++))})),r}var s,f=function(){function t(){this.currentGrid=[],this.maxStep=3,this.best_move=0,this.nodes=0}return t.prototype.run=function(){var t=l.get().getOneDGrid();this.currentGrid=t.map((function(t){return t})),this.startSearch(),c(this.bestMove)},t.prototype.startSearch=function(){this.nodes=0,this.maxStep=3;for(var t=[];;){this.nodes=0;var e=performance.now();if(this.search(this.currentGrid,0),t.push(performance.now()-e),this.nodes>=1e4||this.maxStep>=8)break;this.maxStep+=1}},t.prototype.search=function(t,e){if(this.nodes++,e==this.maxStep)return this.estimate(t);var n=-1;for(var r in s)if(!isNaN(Number(r))){var o=a(t,Number(r)),i=o.reduce((function(t,e){return t+e}));if(!1===o.every((function(e,n){return e==t[n]}))){for(var u=0,f=0,l=0;l<16;++l)0===o[l]&&(o[l]=2,++f,u+=.9*this.search(o,e+1),o[l]=4,u+=.1*this.search(o,e+1),o[l]=0);0!=f?u/=f:u=-1e20,i+u>n&&(n=i+u,0==e&&(this.bestMove=Number(r)))}}return n},t.prototype.estimate=function(t){for(var e=0,n=0,r=0;r<16;r++)0==t[r]&&0,e+=t[r],r%4!=3&&(n+=Math.abs(t[r]-t[r+1])),r<12&&(n+=Math.abs(t[r]-t[r+4]));return 2*(4*e-n)},t}(),l=function(){function t(){this.ai=new f,this.stop=!1,this.fast=!1,this.score=0,this.board=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.prevTime=0}return t.get=function(){return t.instance||(t.instance=new t),t.instance},t.newGame=function(){for(var t=this.instance,e=0;e<4;e++)for(var n=0;n<4;n++){var o=t.board[e][n];o&&(t.board[e][n]=null,o.remove())}for(var a=r.random(),u=r.random();a.equals(u);)u=r.random();var s=i.from(a).draw(),f=i.from(u).draw();t.board[s.x][s.y]=s,t.board[f.x][f.y]=f},t.prototype.boardCopy=function(){for(var t=[],e=0;e<4;e++){var n=this.board[e].map((function(t){return t}));t.push(n)}return t},t.prototype.logBoard=function(t){for(var e=t||this.board,n="",r=0;r<4;r++){for(var o=[],i=0;i<4;i++){var a=e[i][r];a?o.push(Math.pow(2,a.value)):o.push(0)}n+=o.join("\t"),n+="\n"}console.log(n)},Object.defineProperty(t.prototype,"tiles",{get:function(){for(var t=[],e=0;e<4;e++)for(var n=0;n<4;n++){var r=this.board[e][n];r&&t.push(r)}return t},enumerable:!1,configurable:!0}),t.prototype.nextMove=function(t){void 0===t&&(t=100);for(var e=r.random();this.tiles.some((function(t){return t.position.equals(e)}));)e=r.random();var n=i.from(e).draw();this.board[n.x][n.y]=n},t.prototype.getOneDGrid=function(){for(var t=[],e=0;e<4;e++)for(var n=0;n<4;n++){var r=this.board[n][e];r?t.push(Math.pow(2,r.value)):t.push(0)}return t},t.prototype.startAI=function(){var t=this,e=performance.now();this.ai.run();var n=performance.now();if(this.stop)this.stop=!1;else{document.getElementById("score").innerText="Score: "+this.score;var r=100-(n-e);this.fast?requestAnimationFrame((function(){t.startAI()})):setTimeout((function(){t.stop?t.stop=!1:t.startAI()}),r<0?0:r)}},t}();function c(t){var e,n,o,i=l.get(),a=i.boardCopy(),u=i.tiles;t==s.Up?(e=new r(0,0),n=new r(0,-1),o=!0):t==s.Down?(e=new r(0,3),n=new r(0,1),o=!0):t==s.Left?(e=new r(0,0),n=new r(-1,0),o=!1):(e=new r(3,0),n=new r(1,0),o=!1);for(var f=[],c=0;c<4;c++){for(var p=0;p<4;p++){var h=e.clone();o?h.x+=p:h.y+=p,f.push(h)}e.x-=n.x,e.y-=n.y}for(var d=!1,v=0;v<f.length;v++){var y=function(t){var e=u[t];if(e.position.equals(f[v])){var o=e.position.clone();a[e.x][e.y]=null;var s,l=r.add(e.position,n),c=0;if(l.x<0||l.x>3||l.y<0||l.y>3)l=e.position.clone();else for(c=(s=a[l.x][l.y])?s.value:0;0==c;){if(e.position=l.clone(),(l=r.add(e.position,n)).x<0||l.x>3||l.y<0||l.y>3){l=e.position.clone();break}c=(s=a[l.x][l.y])?s.value:0}if(c==e.value)return(s=u[u.findIndex((function(t){return t.position.equals(l)&&t.id!=e.id}))]).value+=1,i.score+=Math.pow(2,s.value),e.position=l,a[s.x][s.y]=s,e.update(!0),u.splice(t,1),e.position.equals(o)||(d=!0),"continue";a[e.x][e.y]=e,e.position.equals(o)||(d=!0)}};for(c=0;c<u.length;c++)y(c)}u.forEach((function(t){t.update()})),d?(i.board=a,i.nextMove()):i.stop=!0}function p(){document.getElementById("root");for(var t=r.random(),e=r.random();t.equals(e);)e=r.random();var n=i.from(t).draw(),o=i.from(e).draw(),a=l.get();a.board[n.x][n.y]=n,a.board[o.x][o.y]=o,window.addEventListener("keyup",(function(t){38==t.which?c(s.Up):40==t.which?c(s.Down):37==t.which?c(s.Left):39==t.which&&c(s.Right),document.getElementById("score").innerText="Score: "+l.get().score}))}!function(t){t[t.Up=1]="Up",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.Right=4]="Right"}(s||(s={})),window.Game=l,p()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RpbGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dyaWQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FpLnRzIiwid2VicGFjazovLy8uL3NyYy9tb3ZlLnRzIiwid2VicGFjazovLy8uL3NyYy9nYW1lLnRzIiwid2VicGFjazovLy8uL3NyYy9zZXR1cC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJ4IiwieSIsInRoaXMiLCJlcXVhbHMiLCJiIiwibWF0Y2hlcyIsImNsb25lIiwiVmVjMiIsImFkZCIsInplcm8iLCJyYW5kb20iLCJNYXRoIiwiZmxvb3IiLCJhIiwicG9zaXRpb25zIiwiaWQiLCJwb3NpdGlvbiIsImRyYXciLCJyb290IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiaW5uZXJUZXh0IiwicG93IiwidG9TdHJpbmciLCJzdHlsZSIsImxlZnQiLCJ0b3AiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ1cGRhdGUiLCJyZW1vdmUiLCJzZXRUaW1lb3V0IiwiY2xhc3NOYW1lIiwiZnJvbSIsIlRpbGUiLCJnZXROZXh0R3JpZCIsImdyaWQiLCJtb3ZlIiwidGVtcCIsIkRpcmVjdGlvbiIsIlVwIiwicm93IiwiaiIsInB1c2giLCJzd2lwZVJvdyIsIkxlZnQiLCJEb3duIiwiUmlnaHQiLCJwcmV2IiwiZm9yRWFjaCIsInZhbCIsImN1cnJlbnRHcmlkIiwibWF4U3RlcCIsImJlc3RfbW92ZSIsIm5vZGVzIiwicnVuIiwidGVtcEdyaWQiLCJnZXRPbmVER3JpZCIsIm1hcCIsInN0YXJ0U2VhcmNoIiwiYmVzdE1vdmUiLCJ0MSIsInBlcmZvcm1hbmNlIiwibm93Iiwic2VhcmNoIiwic3RlcCIsImVzdGltYXRlIiwiYmVzdFNjb3JlIiwiZGlyIiwiaXNOYU4iLCJOdW1iZXIiLCJuZXdHcmlkIiwic2NvcmUiLCJyZWR1Y2UiLCJhY2MiLCJjdXJyZW50IiwiZXZlcnkiLCJpbmRleCIsImVtcHR5Q2VsbHMiLCJzdW0iLCJwZW5hbHR5IiwiemVyb3MiLCJhYnMiLCJhaSIsInN0b3AiLCJmYXN0IiwiYm9hcmQiLCJwcmV2VGltZSIsIkdhbWUiLCJpbnN0YW5jZSIsIm5ld0dhbWUiLCJnYW1lIiwidGlsZSIsInJhbmRvbTEiLCJyYW5kb20yIiwidGlsZTEiLCJ0aWxlMiIsImJvYXJkQ29weSIsImFyciIsImluc2lkZSIsImxvZ0JvYXJkIiwiYm9hcmRTdHJpbmciLCJzdHJpbmciLCJqb2luIiwiY29uc29sZSIsImxvZyIsImxpc3QiLCJuZXh0TW92ZSIsInRpbWUiLCJwb3MiLCJ0aWxlcyIsInNvbWUiLCJzdGFydEFJIiwidDAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJkaXJlY3Rpb24iLCJzdiIsIm1kIiwidmVydGljYWwiLCJzbyIsIm1vdmVkIiwibGVuZ3RoIiwibmV4dCIsIm5leHRWYWx1ZSIsImZpbmRJbmRleCIsInNwbGljZSIsInNldHVwIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwid2hpY2giXSwibWFwcGluZ3MiOiJh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TGhCLEVBQUtQLE1BQU8sRUVsSmIsU0FBUzBDLElBQ2M3RyxTQUFTQyxlQUFlLFFBSWxELElBSkEsSUFDSTJFLEVBQVV4RixFQUFLRyxTQUNmc0YsRUFBVXpGLEVBQUtHLFNBRWJxRixFQUFRNUYsT0FBTzZGLElBQ2pCQSxFQUFVekYsRUFBS0csU0FHbkIsSUFBSXVGLEVBQVEsRUFBSzlELEtBQUs0RCxHQUFTOUUsT0FDM0JpRixFQUFRLEVBQUsvRCxLQUFLNkQsR0FBUy9FLE9BTXpCNEUsRUFBTyxFQUFLaEgsTUFDbEJnSCxFQUFLTCxNQUFNUyxFQUFNakcsR0FBR2lHLEVBQU1oRyxHQUFLZ0csRUFDL0JKLEVBQUtMLE1BQU1VLEVBQU1sRyxHQUFHa0csRUFBTWpHLEdBQUtpRyxFRlovQitCLE9BQU9DLGlCQUFpQixTQUFTLFNBQUFDLEdBRVYsSUFBZkEsRUFBTUMsTUFDTixFQUFLM0YsRUFBVUMsSUFJSyxJQUFmeUYsRUFBTUMsTUFDWCxFQUFLM0YsRUFBVU8sTUFJSyxJQUFmbUYsRUFBTUMsTUFDWCxFQUFLM0YsRUFBVU0sTUFJSyxJQUFmb0YsRUFBTUMsT0FDWCxFQUFLM0YsRUFBVVEsT0FFbkI5QixTQUFTQyxlQUFlLFNBQVVJLFVBQVksVUFBVSxFQUFLM0MsTUFBTTZGLFVBNUIzRSxTQUFZakMsR0FDUixlQUNBLG1CQUNBLG1CQUNBLHFCQUpKLENBQVlBLE1BQVMsS0dDckJ3RixPQUFPdkMsS0FBTyxFQUlWc0MiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLyogMkQgVmVjdG9yIHNlbGYgZXhwbGFuYXRvcnkgKi9cclxuXHJcbmV4cG9ydCBjbGFzcyBWZWMyIHtcclxuICAgIHB1YmxpYyB4OiBudW1iZXI7XHJcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlcXVhbHMoYjogVmVjMik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBiLnggPT0gdGhpcy54ICYmIGIueSA9PSB0aGlzLnk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG1hdGNoZXMoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4geCA9PSB0aGlzLnggJiYgeSA9PSB0aGlzLnk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgY2xvbmUoKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKHRoaXMueCwgdGhpcy55KTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGQoYjogVmVjMikge1xyXG4gICAgICAgIHRoaXMueCArPSBiLng7XHJcbiAgICAgICAgdGhpcy55ICs9IGIueTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgemVybyAoKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKDAsIDApO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIHJhbmRvbSgpOiBWZWMyIHtcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzIoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCksIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpKVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGFkZChhOiBWZWMyLCBiOiBWZWMyKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKGEueCArIGIueCwgYS55ICsgYi55KTtcclxuICAgIH1cclxuICAgIFxyXG59XHJcbiIsImltcG9ydCB7IFZlYzIgfSBmcm9tICcuL3V0aWwnXHJcblxyXG5jb25zdCBwb3NpdGlvbnMgPSBbMCwgMTEyLCAyMjQsIDMzNl07XHJcblxyXG5leHBvcnQgY2xhc3MgVGlsZSB7XHJcbiAgICBwdWJsaWMgcG9zaXRpb246IFZlYzI7XHJcbiAgICBwdWJsaWMgdmFsdWU6IG51bWJlcjtcclxuICAgIHB1YmxpYyBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICAgIHB1YmxpYyBpZCA9IE1hdGgucmFuZG9tKCk7XHJcblxyXG4gICAgcHVibGljIGdldCB4ICgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBvc2l0aW9uLng7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IHkgKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMih4LCB5KTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gKE1hdGgucmFuZG9tKCkgPj0gMC45ID8gMiA6IDEpO1xyXG4gICAgICAgIC8vIHRoaXMudmFsdWUgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwKSArIDE7IC8vIEZvciB0ZXN0aW5nIGNzcyBjbGFzc2VzXHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5zZXJ0cyB0aGUgRWxlbWVudCBpbnRvIHRoZSBET01cclxuICAgIHB1YmxpYyBkcmF3KCkge1xyXG4gICAgICAgIGNvbnN0IHJvb3Q6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyb290XCIpITtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0aWxlXCIpO1xyXG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChgdGlsZS0ke3RoaXMudmFsdWV9YCk7XHJcbiAgICAgICAgZWxlbWVudC5pbm5lclRleHQgPSBNYXRoLnBvdygyLCB0aGlzLnZhbHVlKS50b1N0cmluZygpO1xyXG5cclxuICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSBgJHtwb3NpdGlvbnNbdGhpcy5wb3NpdGlvbi54XX1weGA7XHJcbiAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSBgJHtwb3NpdGlvbnNbdGhpcy5wb3NpdGlvbi55XX1weGA7XHJcbiAgICAgICAgcm9vdC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmVlbmRcIiwgZWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGVzIHRoZSB0ZXh0IGFuZCBjbGFzcyBvZiB0aGUgSFRNTEVsZW1lbnRcclxuICAgIHB1YmxpYyB1cGRhdGUocmVtb3ZlID0gZmFsc2UpIHtcclxuICAgICAgICAvLyBUaGUgdGltZSBpdCB0YWtlcyB0byBtb3ZlIHRoZSB0aWxlIGluIG1zXHJcbiAgICAgICAgY29uc3QgYW5pbWF0aW9uVGltZSA9IDEwMDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IGAke3Bvc2l0aW9uc1t0aGlzLnBvc2l0aW9uLnhdfXB4YDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7cG9zaXRpb25zW3RoaXMucG9zaXRpb24ueV19cHhgO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lID0gYHRpbGUgdGlsZS0ke3RoaXMudmFsdWV9YDtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IE1hdGgucG93KDIsIHRoaXMudmFsdWUpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBhbmltYXRpb25UaW1lKVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlbW92ZXMgdGhlIEhUTUxFbGVtZW50IGZyb20gdGhlIERPTVxyXG4gICAgcHVibGljIHJlbW92ZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JlYXRlcyBhIG5ldyBUaWxlIGZyb20gYSBWZWMyXHJcbiAgICBzdGF0aWMgZnJvbShwb3NpdGlvbjogVmVjMik6IFRpbGUge1xyXG4gICAgICAgIHJldHVybiBuZXcgVGlsZSAocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBEaXJlY3Rpb24gfSBmcm9tIFwiLi9tb3ZlXCI7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE5leHRHcmlkKGdyaWQ6IG51bWJlcltdLCBtb3ZlOiBEaXJlY3Rpb24pOiBudW1iZXJbXSB7XHJcbiAgICBjb25zdCB0ZW1wID0gIFswLCAwLCAwLCAwLFxyXG4gICAgICAgIDAsIDAsIDAsIDAsXHJcbiAgICAgICAgMCwgMCwgMCwgMCxcclxuICAgICAgICAwLCAwLCAwLCAwLF07XHJcblxyXG4gICAgaWYgKG1vdmUgPT0gRGlyZWN0aW9uLlVwKSB7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcm93OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICByb3cucHVzaChncmlkW2kgKyA0KmpdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3cgPSBzd2lwZVJvdyhyb3cpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wW2kgKyA0KmpdID0gcm93W2pdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobW92ZSA9PSBEaXJlY3Rpb24uTGVmdCkge1xyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHJvdzogbnVtYmVyW10gPSBbXTtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgcm93LnB1c2goZ3JpZFs0KmkgKyBqXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcm93ID0gc3dpcGVSb3cocm93KTtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdGVtcFs0KmkgKyBqXSA9IHJvd1tqXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKG1vdmUgPT0gRGlyZWN0aW9uLkRvd24pIHtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciByb3c6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHJvdy5wdXNoKGdyaWRbaSArIDQqKDMtaildKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3cgPSBzd2lwZVJvdyhyb3cpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wW2kgKyA0KigzLWopXSA9IHJvd1tqXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKG1vdmUgPT0gRGlyZWN0aW9uLlJpZ2h0KSB7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcm93OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICByb3cucHVzaChncmlkWzQqaSArICgzLWopXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcm93ID0gc3dpcGVSb3cocm93KTtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdGVtcFs0KmkgKyAoMy1qKV0gPSByb3dbal07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRlbXA7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3dpcGVSb3cocm93OiBudW1iZXJbXSk6IG51bWJlcltdIHtcclxuICAgIGxldCBwcmV2ID0gLTE7XHJcbiAgICBsZXQgaSA9IDA7XHJcbiAgICBsZXQgdGVtcCA9IFswLCAwLCAwLCAwXTtcclxuICAgIHJvdy5mb3JFYWNoKHZhbCA9PiB7XHJcbiAgICAgICAgaWYgKHZhbCAhPSAwKSB7XHJcbiAgICAgICAgICAgIGlmIChwcmV2ID09IDEpIHtcclxuICAgICAgICAgICAgICAgIHByZXYgPSB2YWw7XHJcbiAgICAgICAgICAgICAgICB0ZW1wW2ldID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHByZXYgPT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wW2kgLSAxXSA9IDIgKiBwcmV2O1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHZhbDtcclxuICAgICAgICAgICAgICAgIHRlbXBbaV0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0ZW1wO1xyXG59XHJcblxyXG4iLCJpbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnXHJcbmltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gJy4vbW92ZSc7XHJcbmltcG9ydCB7IGdldE5leHRHcmlkIH0gZnJvbSAnLi9ncmlkJztcclxuaW1wb3J0IHsgbW92ZSB9IGZyb20gJy4vbW92ZSdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFJIHtcclxuICAgIHB1YmxpYyBjdXJyZW50R3JpZDogbnVtYmVyW10gPSBbXTtcclxuICAgIHB1YmxpYyBtYXhTdGVwID0gMztcclxuICAgIHB1YmxpYyBiZXN0X21vdmUgPSAwO1xyXG4gICAgcHVibGljIG5vZGVzID0gMDtcclxuICAgIHB1YmxpYyBiZXN0TW92ZTogRGlyZWN0aW9uO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJ1bigpIHtcclxuICAgICAgICBjb25zdCBnYW1lID0gR2FtZS5nZXQoKTtcclxuICAgICAgICBjb25zdCB0ZW1wR3JpZCA9IGdhbWUuZ2V0T25lREdyaWQoKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRHcmlkID0gdGVtcEdyaWQubWFwKHggPT4geCk7XHJcbiAgICAgICAgdGhpcy5zdGFydFNlYXJjaCgpO1xyXG4gICAgICAgIG1vdmUodGhpcy5iZXN0TW92ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGFydFNlYXJjaCgpIHtcclxuICAgICAgICB0aGlzLm5vZGVzID0gMDtcclxuICAgICAgICB0aGlzLm1heFN0ZXAgPSAzO1xyXG4gICAgICAgIGxldCBub2RlczogbnVtYmVyW10gPSBbXTtcclxuICAgICAgICB3aGlsZSh0cnVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZXMgPSAwO1xyXG4gICAgICAgICAgICBsZXQgdDEgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2godGhpcy5jdXJyZW50R3JpZCwgMCk7XHJcbiAgICAgICAgICAgIG5vZGVzLnB1c2gocGVyZm9ybWFuY2Uubm93KCktdDEpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlcyA+PSAxMDAwMCB8fCB0aGlzLm1heFN0ZXAgPj0gOCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tYXhTdGVwICs9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2VhcmNoKGdyaWQ6IG51bWJlcltdLCBzdGVwOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgICAgIHRoaXMubm9kZXMrKztcclxuICAgICAgICBpZiAoc3RlcCA9PSB0aGlzLm1heFN0ZXApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXN0aW1hdGUoZ3JpZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBiZXN0U2NvcmUgPSAtMTtcclxuICAgICAgICBmb3IgKGNvbnN0IGRpciBpbiBEaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgaWYgKGlzTmFOKE51bWJlcihkaXIpKSkgY29udGludWU7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0dyaWQgPSBnZXROZXh0R3JpZChncmlkLCBOdW1iZXIoZGlyKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjb3JlID0gbmV3R3JpZC5yZWR1Y2UoKGFjYywgY3VycmVudCkgPT4gYWNjICs9IGN1cnJlbnQpO1xyXG4gICAgICAgICAgICBjb25zdCBzYW1lID0gbmV3R3JpZC5ldmVyeSgodmFsdWUsIGluZGV4KSA9PiB2YWx1ZSA9PSBncmlkW2luZGV4XSk7XHJcbiAgICAgICAgICAgIGlmIChzYW1lID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRlbXAgPSAwO1xyXG4gICAgICAgICAgICAgICAgbGV0IGVtcHR5Q2VsbHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0dyaWRbaV0gPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3R3JpZFtpXSA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICsrZW1wdHlDZWxscztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCArPSB0aGlzLnNlYXJjaChuZXdHcmlkLCBzdGVwICsgMSkgKiAwLjk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0dyaWRbaV0gPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wICs9IHRoaXMuc2VhcmNoKG5ld0dyaWQsIHN0ZXAgKyAxKSAqIDAuMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3R3JpZFtpXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGVtcHR5Q2VsbHMgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXAgLz0gZW1wdHlDZWxscztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSAtMWUrMjA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNjb3JlICsgdGVtcCA+IGJlc3RTY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJlc3RTY29yZSA9IHNjb3JlICsgdGVtcDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVzdE1vdmUgPSBOdW1iZXIoZGlyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJlc3RTY29yZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVzdGltYXRlKGdyaWQ6IG51bWJlcltdKTogbnVtYmVyIHtcclxuICAgICAgICBsZXQgc3VtID0gMDtcclxuICAgICAgICBsZXQgcGVuYWx0eSA9IDA7XHJcbiAgICAgICAgbGV0IHplcm9zID0gMDtcclxuICAgICAgICBmb3IobGV0IGkgPTA7IGkgPCAxNjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChncmlkW2ldID09IDApIHplcm9zKys7XHJcbiAgICAgICAgICAgIHN1bSArPSBncmlkW2ldO1xyXG4gICAgICAgICAgICBpZihpICUgNCAhPSAzKSB7XHJcbiAgICAgICAgICAgICAgICBwZW5hbHR5ICs9IE1hdGguYWJzKGdyaWRbaV0gLSBncmlkW2kgKyAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoaSA8IDEyKSB7XHJcbiAgICAgICAgICAgICAgICBwZW5hbHR5ICs9IE1hdGguYWJzKGdyaWRbaV0gLSBncmlkW2kgKyA0XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIChzdW0gKiA0IC0gcGVuYWx0eSkgKiAyO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgVmVjMiB9IGZyb20gJy4vdXRpbCdcclxuaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJ1xyXG5pbXBvcnQgeyBUaWxlIH0gZnJvbSAnLi90aWxlJ1xyXG5cclxuZXhwb3J0IGVudW0gRGlyZWN0aW9uIHtcclxuICAgIFVwID0gMSxcclxuICAgIERvd24sXHJcbiAgICBMZWZ0LFxyXG4gICAgUmlnaHRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRLZXlFdmVudHMoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGV2ZW50ID0+IHtcclxuICAgICAgICAvKiBLZXkgdXAgKi9cclxuICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT0gMzgpIHtcclxuICAgICAgICAgICAgbW92ZShEaXJlY3Rpb24uVXApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogS2V5IGRvd24gKi9cclxuICAgICAgICBlbHNlIGlmIChldmVudC53aGljaCA9PSA0MCkge1xyXG4gICAgICAgICAgICBtb3ZlKERpcmVjdGlvbi5Eb3duKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qIEtleSBsZWZ0ICovXHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQud2hpY2ggPT0gMzcpIHtcclxuICAgICAgICAgICAgbW92ZShEaXJlY3Rpb24uTGVmdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBLZXkgcmlnaHQgKi9cclxuICAgICAgICBlbHNlIGlmIChldmVudC53aGljaCA9PSAzOSkge1xyXG4gICAgICAgICAgICBtb3ZlKERpcmVjdGlvbi5SaWdodCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2NvcmVcIikhLmlubmVyVGV4dCA9IGBTY29yZTogJHtHYW1lLmdldCgpLnNjb3JlfWA7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1vdmUoZGlyZWN0aW9uOiBEaXJlY3Rpb24pIHtcclxuICAgIGNvbnN0IGdhbWUgPSBHYW1lLmdldCgpO1xyXG4gICAgbGV0IGJvYXJkID0gZ2FtZS5ib2FyZENvcHkoKTtcclxuICAgIGxldCB0aWxlcyA9IGdhbWUudGlsZXM7XHJcbiAgICBsZXQgc3Y6IFZlYzI7IC8vIFNvcnRpbmcgdmVjdG9yXHJcbiAgICBsZXQgbWQ6IFZlYzI7IC8vIE1vdmUgRGlyZWN0aW9uXHJcbiAgICBsZXQgdmVydGljYWw6IGJvb2xlYW47IFxyXG5cclxuICAgIC8vIEFzc2lnbiB0aGUgcmlnaHQgZGlyZWN0aW9uIGZvciBlYWNoIG1vdmVtZW50ICh4LCB5KVxyXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBEaXJlY3Rpb24uVXApIHtcclxuICAgICAgICBzdiA9IG5ldyBWZWMyKDAsIDApO1xyXG4gICAgICAgIG1kID0gbmV3IFZlYzIoMCwgLTEpO1xyXG4gICAgICAgIHZlcnRpY2FsID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBEaXJlY3Rpb24uRG93bikge1xyXG4gICAgICAgIHN2ID0gbmV3IFZlYzIoMCwgMyk7XHJcbiAgICAgICAgbWQgPSBuZXcgVmVjMigwLCAxKTtcclxuICAgICAgICB2ZXJ0aWNhbCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChkaXJlY3Rpb24gPT0gRGlyZWN0aW9uLkxlZnQpIHtcclxuICAgICAgICBzdiA9IG5ldyBWZWMyKDAsIDApO1xyXG4gICAgICAgIG1kID0gbmV3IFZlYzIoLTEsIDApO1xyXG4gICAgICAgIHZlcnRpY2FsID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBlbHNlIHsgLy8gaWYgKGRpcmVjdGlvbiA9PSBEaXJlY3Rpb24uUmlnaHQpXHJcbiAgICAgICAgc3YgPSBuZXcgVmVjMigzLCAwKTtcclxuICAgICAgICBtZCA9IG5ldyBWZWMyKDEsIDApO1xyXG4gICAgICAgIHZlcnRpY2FsID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNvOiBWZWMyW10gPSBbXTsgLy8gU29ydGluZyBvcmRlciBvZiBlYWNoIHNxdWFyZVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgbGV0IHRlbXAgPSBzdi5jbG9uZSgpO1xyXG4gICAgICAgICAgICBpZiAodmVydGljYWwpIHtcclxuICAgICAgICAgICAgICAgIHRlbXAueCArPSBqO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGVtcC55ICs9IGo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc28ucHVzaCh0ZW1wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3YueCAtPSBtZC54O1xyXG4gICAgICAgIHN2LnkgLT0gbWQueTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGV0ZXJtaW5lcyBpZiBhbnkgdGlsZSBoYXMgYWN0dWFsbHkgbW92ZWRcclxuICAgIGxldCBtb3ZlZCA9IGZhbHNlO1xyXG5cclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc28ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCB0aWxlID0gdGlsZXNbaV07XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBjdXJyZW50IHRpbGUncyBwb3NpdGlvbiBpcyBlcXVhbCB0byB0aGUgc29ydGluZyBvcmRlciB2ZWN0b3JcclxuICAgICAgICAgICAgaWYgKHRpbGUucG9zaXRpb24uZXF1YWxzKHNvW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHByZXYgPSB0aWxlLnBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBib2FyZFt0aWxlLnhdW3RpbGUueV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgLy8gTmV4dCBwb3NpdGlvbiBpZiB0aGUgdGlsZSBpcyBtb3ZlZCAxIHN0ZXAgaW50byB0aGUgbW92ZSBkaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgIGxldCBtb3ZlVG8gPSBWZWMyLmFkZCh0aWxlLnBvc2l0aW9uLCBtZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG5leHRWYWx1ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAobW92ZVRvLnggPCAwIHx8IG1vdmVUby54ID4gMyB8fCBtb3ZlVG8ueSA8IDAgfHwgbW92ZVRvLnkgPiAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZVRvID0gdGlsZS5wb3NpdGlvbi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHQgPSBib2FyZFttb3ZlVG8ueF1bbW92ZVRvLnldO1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRWYWx1ZSA9ICBuZXh0ID8gbmV4dC52YWx1ZSA6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUobmV4dFZhbHVlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5wb3NpdGlvbiA9IG1vdmVUby5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlVG8gPSBWZWMyLmFkZCh0aWxlLnBvc2l0aW9uLCBtZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW92ZVRvLnggPCAwIHx8IG1vdmVUby54ID4gMyB8fCBtb3ZlVG8ueSA8IDAgfHwgbW92ZVRvLnkgPiAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZlVG8gPSB0aWxlLnBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGJvYXJkW21vdmVUby54XVttb3ZlVG8ueV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRWYWx1ZSA9ICBuZXh0ID8gbmV4dC52YWx1ZSA6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRWYWx1ZSA9PSB0aWxlLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAgICAqICAgdGlsZSBpcyBiZWluZyByZW1vdmVkXHJcbiAgICAgICAgICAgICAgICAgICAgKiAgIG5leHQgaXMgdGhlIHRpbGVzIGxhdGVyIGluIHRoZSBzb3J0aW5nIG9yZGVyIHdpdGggdGhlIHNhbWUgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXh0ID0gdGlsZXNbdGlsZXMuZmluZEluZGV4KHQgPT4gdC5wb3NpdGlvbi5lcXVhbHMobW92ZVRvKSAmJiB0LmlkICE9IHRpbGUuaWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0LnZhbHVlICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5zY29yZSArPSBNYXRoLnBvdygyLCBuZXh0LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aWxlLnBvc2l0aW9uID0gbW92ZVRvO1xyXG4gICAgICAgICAgICAgICAgICAgIGJvYXJkW25leHQueF1bbmV4dC55XSA9IG5leHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTW92ZSB0aWxlXHJcbiAgICAgICAgICAgICAgICAgICAgdGlsZS51cGRhdGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGlsZXMuc3BsaWNlKGksIDEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRpbGUucG9zaXRpb24uZXF1YWxzKHByZXYpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBib2FyZFt0aWxlLnhdW3RpbGUueV0gPSB0aWxlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdGlsZS5wb3NpdGlvbi5lcXVhbHMocHJldikpIHtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aWxlcy5mb3JFYWNoKHRpbGUgPT4ge1xyXG4gICAgICAgIHRpbGUudXBkYXRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAobW92ZWQpIHtcclxuICAgICAgICBnYW1lLmJvYXJkID0gYm9hcmQ7XHJcbiAgICAgICAgZ2FtZS5uZXh0TW92ZSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgZ2FtZS5zdG9wID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxuIiwiaW1wb3J0IHsgVGlsZSB9IGZyb20gJy4vdGlsZSdcclxuaW1wb3J0IHsgVmVjMiB9IGZyb20gJy4vdXRpbCc7XHJcbmltcG9ydCBBSSBmcm9tICcuL2FpJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZSB7XHJcbiAgICAvKiBTaW5nbGVUb24gc2V0dXAgKi9cclxuICAgIC8vICsrKysrKysrKysrKysrKysrKysrKysrKytcclxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBHYW1lO1xyXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0KCkge1xyXG4gICAgICAgIGlmICghR2FtZS5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBHYW1lLmluc3RhbmNlID0gbmV3IEdhbWUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEdhbWUuaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFN0YXRpYyBNZXRob2RzXHJcbiAgICBwdWJsaWMgc3RhdGljIG5ld0dhbWUoKSB7XHJcbiAgICAgICAgY29uc3QgZ2FtZSA9IHRoaXMuaW5zdGFuY2U7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCB0aWxlID0gZ2FtZS5ib2FyZFtpXVtqXTtcclxuICAgICAgICAgICAgICAgIGlmICh0aWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5ib2FyZFtpXVtqXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGlsZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcmFuZG9tMSA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICAgICAgbGV0IHJhbmRvbTIgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgcmFuZG9tIHBvc2l0aW9ucyBhcmVuJ3QgdGhlIHNhbWVcclxuICAgICAgICB3aGlsZShyYW5kb20xLmVxdWFscyhyYW5kb20yKSkge1xyXG4gICAgICAgICAgICByYW5kb20yID0gVmVjMi5yYW5kb20oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB0aWxlMSA9IFRpbGUuZnJvbShyYW5kb20xKS5kcmF3KCk7XHJcbiAgICAgICAgbGV0IHRpbGUyID0gVGlsZS5mcm9tKHJhbmRvbTIpLmRyYXcoKTtcclxuXHJcbiAgICAgICAgLy8gSW5zZXJ0IHRoZSB0aWxlcyBpbnRvIHRoZSBnYW1lIGJvYXJkXHJcbiAgICAgICAgZ2FtZS5ib2FyZFt0aWxlMS54XVt0aWxlMS55XSA9IHRpbGUxO1xyXG4gICAgICAgIGdhbWUuYm9hcmRbdGlsZTIueF1bdGlsZTIueV0gPSB0aWxlMjtcclxuICAgIH1cclxuICAgIC8vICsrKysrKysrKysrKysrKysrKysrKysrKytcclxuICAgIHB1YmxpYyBhaTogQUkgPSBuZXcgQUkoKTtcclxuICAgIHB1YmxpYyBzdG9wOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgZmFzdDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHVibGljIHNjb3JlOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIC8vIEluc3RhbmNlIG1ldGhvZHNcclxuICAgIHB1YmxpYyBib2FyZDogKFRpbGUgfCBudWxsKVtdW10gPSBbW251bGwsIG51bGwsIG51bGwsIG51bGxdLCBbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF0sIFtudWxsLCBudWxsLCBudWxsLCBudWxsXSwgW251bGwsIG51bGwsIG51bGwsIG51bGxdXTtcclxuICAgIHB1YmxpYyBib2FyZENvcHkoKTogKFRpbGUgfCBudWxsKVtdW10ge1xyXG4gICAgICAgIGxldCBhcnI6IChUaWxlIHwgbnVsbClbXVtdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGluc2lkZSA9IHRoaXMuYm9hcmRbaV0ubWFwKHggPT4geCk7XHJcbiAgICAgICAgICAgIGFyci5wdXNoKGluc2lkZSk7XHJcbiAgICAgICAgfSAgICBcclxuICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExvZ3MgdGhlIGdhbWUgYm9hcmQgbGlrZSB0aGUgd2F5IGl0IGFwcGVhcnMgb24gc2NyZWVuXHJcbiAgICBwdWJsaWMgbG9nQm9hcmQoYj86IChUaWxlIHwgbnVsbClbXVtdKSB7XHJcbiAgICAgICAgbGV0IGZyb20gPSBiIHx8IHRoaXMuYm9hcmQ7XHJcbiAgICAgICAgbGV0IGJvYXJkU3RyaW5nID0gXCJcIjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgc3RyaW5nOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbGUgPSBmcm9tW2pdW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJpbmcucHVzaChNYXRoLnBvdygyLCB0aWxlLnZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHN0cmluZy5wdXNoKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBzdHIgPSBzdHJpbmcuam9pbihcIlxcdFwiKTtcclxuICAgICAgICAgICAgYm9hcmRTdHJpbmcgKz0gc3RyO1xyXG4gICAgICAgICAgICBib2FyZFN0cmluZyArPSBcIlxcblwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhib2FyZFN0cmluZyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJucyBhIGxpc3Qgb2YgYWxsIHRoZSBvbiB0aGUgYm9hcmRcclxuICAgIHB1YmxpYyBnZXQgdGlsZXMgKCk6IFRpbGVbXSB7XHJcbiAgICAgICAgbGV0IGxpc3Q6IFRpbGVbXSA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGlsZSA9IHRoaXMuYm9hcmRbaV1bal07XHJcbiAgICAgICAgICAgICAgICBpZiAodGlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaCh0aWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIG5leHRNb3ZlKHRpbWUgPSAxMDApIHtcclxuICAgICAgICBsZXQgcG9zID0gVmVjMi5yYW5kb20oKTtcclxuICAgICAgICB3aGlsZSh0aGlzLnRpbGVzLnNvbWUodGlsZSA9PiB0aWxlLnBvc2l0aW9uLmVxdWFscyhwb3MpKSkge1xyXG4gICAgICAgICAgICBwb3MgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0aWxlID0gVGlsZS5mcm9tKHBvcykuZHJhdygpO1xyXG4gICAgICAgIHRoaXMuYm9hcmRbdGlsZS54XVt0aWxlLnldID0gdGlsZTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0T25lREdyaWQoKTogbnVtYmVyW10ge1xyXG4gICAgICAgIGxldCBncmlkOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgNDsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvcihsZXQgeSA9IDA7IHkgPCA0OyB5KyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRpbGUgPSB0aGlzLmJvYXJkW3ldW3hdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkLnB1c2goTWF0aC5wb3coMiwgdGlsZS52YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZC5wdXNoKDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBncmlkO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBwcmV2VGltZTogbnVtYmVyID0gMDtcclxuXHJcbiAgICBwdWJsaWMgc3RhcnRBSSgpIHtcclxuICAgICAgICBsZXQgdDAgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgICAgICB0aGlzLmFpLnJ1bigpO1xyXG4gICAgICAgIGxldCB0MSA9IHBlcmZvcm1hbmNlLm5vdygpOyBcclxuICAgICAgICBpZiAodGhpcy5zdG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2NvcmVcIikhLmlubmVyVGV4dCA9IGBTY29yZTogJHt0aGlzLnNjb3JlfWA7XHJcbiAgICAgICAgY29uc3QgdGltZSA9IDEwMCAtICh0MSAtIHQwKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIXRoaXMuZmFzdCkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0b3ApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QUkoKTtcclxuICAgICAgICAgICAgfSwgdGltZSA8IDAgPyAwIDogdGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFJKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBcclxufSIsImltcG9ydCB7IFRpbGUgfSBmcm9tICcuL3RpbGUnXHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tICcuL3V0aWwnXHJcbmltcG9ydCB7IGJpbmRLZXlFdmVudHMgfSBmcm9tICcuL21vdmUnXHJcbmltcG9ydCBHYW1lIGZyb20gJy4vZ2FtZSc7XHJcblxyXG4vLyBBZGRzIHR3byByYW5kb20gdGlsZXMgdG8gdGhlIGdhbWUgYm9hcmQgYW5kIGludG8gdGhlIERPTVxyXG5leHBvcnQgZnVuY3Rpb24gc2V0dXAoKSB7XHJcbiAgICBjb25zdCByb290OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm9vdFwiKSE7XHJcbiAgICBsZXQgcmFuZG9tMSA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICBsZXQgcmFuZG9tMiA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICAvLyBNYWtlIHN1cmUgdGhlIHJhbmRvbSBwb3NpdGlvbnMgYXJlbid0IHRoZSBzYW1lXHJcbiAgICB3aGlsZShyYW5kb20xLmVxdWFscyhyYW5kb20yKSkge1xyXG4gICAgICAgIHJhbmRvbTIgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCB0aWxlMSA9IFRpbGUuZnJvbShyYW5kb20xKS5kcmF3KCk7XHJcbiAgICBsZXQgdGlsZTIgPSBUaWxlLmZyb20ocmFuZG9tMikuZHJhdygpO1xyXG4gICAgXHJcbiAgICAvLyBsZXQgdGlsZTEgPSBuZXcgVGlsZSgzLCAxKS5kcmF3KCk7XHJcbiAgICAvLyBsZXQgdGlsZTIgPSBuZXcgVGlsZSgwLCAzKS5kcmF3KCk7XHJcblxyXG4gICAgLy8gSW5zZXJ0IHRoZSB0aWxlcyBpbnRvIHRoZSBnYW1lIGJvYXJkXHJcbiAgICBjb25zdCBnYW1lID0gR2FtZS5nZXQoKTtcclxuICAgIGdhbWUuYm9hcmRbdGlsZTEueF1bdGlsZTEueV0gPSB0aWxlMTtcclxuICAgIGdhbWUuYm9hcmRbdGlsZTIueF1bdGlsZTIueV0gPSB0aWxlMjtcclxuXHJcbiAgICBiaW5kS2V5RXZlbnRzKCk7XHJcbn0iLCJpbXBvcnQgeyBzZXR1cCB9IGZyb20gJy4vc2V0dXAnXHJcbmltcG9ydCBHYW1lIGZyb20gJy4vZ2FtZSdcclxuaW1wb3J0IHsgc3dpcGVSb3cgfSBmcm9tICcuL2dyaWQnXHJcblxyXG4vL0B0cy1pZ25vcmVcclxud2luZG93LkdhbWUgPSBHYW1lO1xyXG5cclxuXHJcbigoKSA9PiB7XHJcbiAgICBzZXR1cCgpO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiIn0=
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.equals=function(t){return t.x==this.x&&t.y==this.y},t.prototype.matches=function(t,e){return t==this.x&&e==this.y},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.add=function(t){this.x+=t.x,this.y+=t.y},t.zero=function(){return new t(0,0)},t.random=function(){return new t(Math.floor(4*Math.random()),Math.floor(4*Math.random()))},t.add=function(e,n){return new t(e.x+n.x,e.y+n.y)},t}(),o=[0,112,224,336],i=[-12,70,151,232],a=function(){function t(t,e){this.id=Math.random(),this.position=new r(t,e),this.value=Math.random()>=.9?2:1,this.positions=window.innerWidth>600?o:i}return Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},enumerable:!1,configurable:!0}),t.prototype.draw=function(){var t=document.getElementById("root"),e=document.createElement("div");return e.classList.add("tile"),e.classList.add("tile-"+this.value),e.innerText=Math.pow(2,this.value).toString(),e.style.left=this.positions[this.position.x]+"px",e.style.top=this.positions[this.position.y]+"px",t.insertAdjacentElement("beforeend",e),this.element=e,this},t.prototype.update=function(t){var e=this;void 0===t&&(t=!1);return this.element.style.left=this.positions[this.position.x]+"px",this.element.style.top=this.positions[this.position.y]+"px",setTimeout((function(){e.element.className="tile tile-"+e.value,e.element.innerText=Math.pow(2,e.value).toString(),t&&e.remove()}),100),this},t.prototype.remove=function(){this.element.remove()},t.from=function(e){return new t(e.x,e.y)},t}();function s(t,e){var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(e==f.Up)for(var r=0;r<4;r++){for(var o=[],i=0;i<4;i++)o.push(t[r+4*i]);o=u(o);for(i=0;i<4;i++)n[r+4*i]=o[i]}else if(e==f.Left)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[4*r+i]);o=u(o);for(i=0;i<4;i++)n[4*r+i]=o[i]}else if(e==f.Down)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[r+4*(3-i)]);o=u(o);for(i=0;i<4;i++)n[r+4*(3-i)]=o[i]}else if(e==f.Right)for(r=0;r<4;r++){for(o=[],i=0;i<4;i++)o.push(t[4*r+(3-i)]);o=u(o);for(i=0;i<4;i++)n[4*r+(3-i)]=o[i]}return n}function u(t){var e=-1,n=0,r=[0,0,0,0];return t.forEach((function(t){0!=t&&(1==e?(e=t,r[n]=t,n++):e==t?(r[n-1]=2*e,e=-1):(e=t,r[n]=t,n++))})),r}var f,c=function(){function t(){this.currentGrid=[],this.maxStep=3,this.best_move=0,this.nodes=0}return t.prototype.run=function(){var t=l.get().getOneDGrid();this.currentGrid=t.map((function(t){return t})),this.startSearch(),p(this.bestMove)},t.prototype.startSearch=function(){this.nodes=0,this.maxStep=3;for(var t=[];;){this.nodes=0;var e=performance.now();if(this.search(this.currentGrid,0),t.push(performance.now()-e),this.nodes>=1e4||this.maxStep>=8)break;this.maxStep+=1}},t.prototype.search=function(t,e){if(this.nodes++,e==this.maxStep)return this.estimate(t);var n=-1;for(var r in f)if(!isNaN(Number(r))){var o=s(t,Number(r)),i=o.reduce((function(t,e){return t+e}));if(!1===o.every((function(e,n){return e==t[n]}))){for(var a=0,u=0,c=0;c<16;++c)0===o[c]&&(o[c]=2,++u,a+=.9*this.search(o,e+1),o[c]=4,a+=.1*this.search(o,e+1),o[c]=0);0!=u?a/=u:a=-1e20,i+a>n&&(n=i+a,0==e&&(this.bestMove=Number(r)))}}return n},t.prototype.estimate=function(t){for(var e=0,n=0,r=0;r<16;r++)0==t[r]&&0,e+=t[r],r%4!=3&&(n+=Math.abs(t[r]-t[r+1])),r<12&&(n+=Math.abs(t[r]-t[r+4]));return 2*(4*e-n)},t}(),l=function(){function t(){this.ai=new c,this.stop=!1,this.fast=!1,this.score=0,this.board=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.prevTime=0}return t.get=function(){return t.instance||(t.instance=new t),t.instance},t.newGame=function(){for(var t=this.instance,e=0;e<4;e++)for(var n=0;n<4;n++){var o=t.board[e][n];o&&(t.board[e][n]=null,o.remove())}for(var i=r.random(),s=r.random();i.equals(s);)s=r.random();var u=a.from(i).draw(),f=a.from(s).draw();t.board[u.x][u.y]=u,t.board[f.x][f.y]=f},t.prototype.boardCopy=function(){for(var t=[],e=0;e<4;e++){var n=this.board[e].map((function(t){return t}));t.push(n)}return t},t.prototype.logBoard=function(t){for(var e=t||this.board,n="",r=0;r<4;r++){for(var o=[],i=0;i<4;i++){var a=e[i][r];a?o.push(Math.pow(2,a.value)):o.push(0)}n+=o.join("\t"),n+="\n"}console.log(n)},Object.defineProperty(t.prototype,"tiles",{get:function(){for(var t=[],e=0;e<4;e++)for(var n=0;n<4;n++){var r=this.board[e][n];r&&t.push(r)}return t},enumerable:!1,configurable:!0}),t.prototype.nextMove=function(t){void 0===t&&(t=100);for(var e=r.random();this.tiles.some((function(t){return t.position.equals(e)}));)e=r.random();var n=a.from(e).draw();this.board[n.x][n.y]=n},t.prototype.getOneDGrid=function(){for(var t=[],e=0;e<4;e++)for(var n=0;n<4;n++){var r=this.board[n][e];r?t.push(Math.pow(2,r.value)):t.push(0)}return t},t.prototype.startAI=function(){var t=this,e=performance.now();this.ai.run();var n=performance.now();if(this.stop)this.stop=!1;else{document.getElementById("score").innerText="Score: "+this.score;var r=100-(n-e);this.fast?requestAnimationFrame((function(){t.startAI()})):setTimeout((function(){t.stop?t.stop=!1:t.startAI()}),r<0?0:r)}},t.prototype.newGame=function(){this.tiles.forEach((function(t){t.remove()}));for(var t=0;t<4;t++)for(var e=0;e<4;e++)this.board[t][e]=null;for(var n=r.random(),o=r.random();n.equals(o);)o=r.random();var i=a.from(n).draw(),s=a.from(o).draw();this.board[i.x][i.y]=i,this.board[s.x][s.y]=s,this.score=0,document.getElementById("score").innerHTML="Score: 0"},t}();function p(t){var e,n,o,i=l.get(),a=i.boardCopy(),s=i.tiles;t==f.Up?(e=new r(0,0),n=new r(0,-1),o=!0):t==f.Down?(e=new r(0,3),n=new r(0,1),o=!0):t==f.Left?(e=new r(0,0),n=new r(-1,0),o=!1):(e=new r(3,0),n=new r(1,0),o=!1);for(var u=[],c=0;c<4;c++){for(var p=0;p<4;p++){var h=e.clone();o?h.x+=p:h.y+=p,u.push(h)}e.x-=n.x,e.y-=n.y}for(var d=!1,v=0;v<u.length;v++){var m=function(t){var e=s[t];if(e.position.equals(u[v])){var o=e.position.clone();a[e.x][e.y]=null;var f,c=r.add(e.position,n),l=0;if(c.x<0||c.x>3||c.y<0||c.y>3)c=e.position.clone();else for(l=(f=a[c.x][c.y])?f.value:0;0==l;){if(e.position=c.clone(),(c=r.add(e.position,n)).x<0||c.x>3||c.y<0||c.y>3){c=e.position.clone();break}l=(f=a[c.x][c.y])?f.value:0}if(l==e.value)return(f=s[s.findIndex((function(t){return t.position.equals(c)&&t.id!=e.id}))]).value+=1,i.score+=Math.pow(2,f.value),e.position=c,a[f.x][f.y]=f,e.update(!0),s.splice(t,1),e.position.equals(o)||(d=!0),"continue";a[e.x][e.y]=e,e.position.equals(o)||(d=!0)}};for(c=0;c<s.length;c++)m(c)}s.forEach((function(t){t.update()})),d?(i.board=a,i.nextMove()):i.stop=!0}function h(){document.getElementById("root");for(var t=r.random(),e=r.random();t.equals(e);)e=r.random();var n=a.from(t).draw(),o=a.from(e).draw(),i=l.get();i.board[n.x][n.y]=n,i.board[o.x][o.y]=o,window.addEventListener("keyup",(function(t){38==t.which?p(f.Up):40==t.which?p(f.Down):37==t.which?p(f.Left):39==t.which&&p(f.Right),document.getElementById("score").innerText="Score: "+l.get().score}))}!function(t){t[t.Up=1]="Up",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.Right=4]="Right"}(f||(f={})),window.Game=l,h()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RpbGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dyaWQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FpLnRzIiwid2VicGFjazovLy8uL3NyYy9tb3ZlLnRzIiwid2VicGFjazovLy8uL3NyYy9nYW1lLnRzIiwid2VicGFjazovLy8uL3NyYy9zZXR1cC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJ4IiwieSIsInRoaXMiLCJlcXVhbHMiLCJiIiwibWF0Y2hlcyIsImNsb25lIiwiVmVjMiIsImFkZCIsInplcm8iLCJyYW5kb20iLCJNYXRoIiwiZmxvb3IiLCJhIiwicG9zaXRpb25zIiwicG9zaXRpb25zUGhvbmUiLCJpZCIsInBvc2l0aW9uIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImRyYXciLCJyb290IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiaW5uZXJUZXh0IiwicG93IiwidG9TdHJpbmciLCJzdHlsZSIsImxlZnQiLCJ0b3AiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ1cGRhdGUiLCJyZW1vdmUiLCJzZXRUaW1lb3V0IiwiY2xhc3NOYW1lIiwiZnJvbSIsIlRpbGUiLCJnZXROZXh0R3JpZCIsImdyaWQiLCJtb3ZlIiwidGVtcCIsIkRpcmVjdGlvbiIsIlVwIiwicm93IiwiaiIsInB1c2giLCJzd2lwZVJvdyIsIkxlZnQiLCJEb3duIiwiUmlnaHQiLCJwcmV2IiwiZm9yRWFjaCIsInZhbCIsImN1cnJlbnRHcmlkIiwibWF4U3RlcCIsImJlc3RfbW92ZSIsIm5vZGVzIiwicnVuIiwidGVtcEdyaWQiLCJnZXRPbmVER3JpZCIsIm1hcCIsInN0YXJ0U2VhcmNoIiwiYmVzdE1vdmUiLCJ0MSIsInBlcmZvcm1hbmNlIiwibm93Iiwic2VhcmNoIiwic3RlcCIsImVzdGltYXRlIiwiYmVzdFNjb3JlIiwiZGlyIiwiaXNOYU4iLCJOdW1iZXIiLCJuZXdHcmlkIiwic2NvcmUiLCJyZWR1Y2UiLCJhY2MiLCJjdXJyZW50IiwiZXZlcnkiLCJpbmRleCIsImVtcHR5Q2VsbHMiLCJzdW0iLCJwZW5hbHR5IiwiemVyb3MiLCJhYnMiLCJhaSIsInN0b3AiLCJmYXN0IiwiYm9hcmQiLCJwcmV2VGltZSIsIkdhbWUiLCJpbnN0YW5jZSIsIm5ld0dhbWUiLCJnYW1lIiwidGlsZSIsInJhbmRvbTEiLCJyYW5kb20yIiwidGlsZTEiLCJ0aWxlMiIsImJvYXJkQ29weSIsImFyciIsImluc2lkZSIsImxvZ0JvYXJkIiwiYm9hcmRTdHJpbmciLCJzdHJpbmciLCJqb2luIiwiY29uc29sZSIsImxvZyIsImxpc3QiLCJuZXh0TW92ZSIsInRpbWUiLCJwb3MiLCJ0aWxlcyIsInNvbWUiLCJzdGFydEFJIiwidDAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJpbm5lckhUTUwiLCJkaXJlY3Rpb24iLCJzdiIsIm1kIiwidmVydGljYWwiLCJzbyIsIm1vdmVkIiwibGVuZ3RoIiwibmV4dCIsIm5leHRWYWx1ZSIsImZpbmRJbmRleCIsInNwbGljZSIsInNldHVwIiwiYWRkRXZl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QUFNcEcsR0FBR29HLEVBQU1uRyxHQUFLbUcsRUFDL0JKLEVBQUtMLE1BQU1VLEVBQU1yRyxHQUFHcUcsRUFBTXBHLEdBQUtvRyxFRlovQm5GLE9BQU9tSCxpQkFBaUIsU0FBUyxTQUFBQyxHQUVWLElBQWZBLEVBQU1DLE1BQ04sRUFBSzNGLEVBQVVDLElBSUssSUFBZnlGLEVBQU1DLE1BQ1gsRUFBSzNGLEVBQVVPLE1BSUssSUFBZm1GLEVBQU1DLE1BQ1gsRUFBSzNGLEVBQVVNLE1BSUssSUFBZm9GLEVBQU1DLE9BQ1gsRUFBSzNGLEVBQVVRLE9BRW5COUIsU0FBU0MsZUFBZSxTQUFVSSxVQUFZLFVBQVUsRUFBSzlDLE1BQU1nRyxVQTVCM0UsU0FBWWpDLEdBQ1IsZUFDQSxtQkFDQSxtQkFDQSxxQkFKSixDQUFZQSxNQUFTLEtHQ3JCMUIsT0FBTzJFLEtBQU8sRUFJVnVDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIi8qIDJEIFZlY3RvciBzZWxmIGV4cGxhbmF0b3J5ICovXHJcblxyXG5leHBvcnQgY2xhc3MgVmVjMiB7XHJcbiAgICBwdWJsaWMgeDogbnVtYmVyO1xyXG4gICAgcHVibGljIHk6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgdGhpcy55ID0geTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZXF1YWxzKGI6IFZlYzIpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gYi54ID09IHRoaXMueCAmJiBiLnkgPT0gdGhpcy55O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBtYXRjaGVzKHg6IG51bWJlciwgeTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHggPT0gdGhpcy54ICYmIHkgPT0gdGhpcy55O1xyXG4gICAgfVxyXG4gICAgcHVibGljIGNsb25lKCk6IFZlYzIge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjMih0aGlzLngsIHRoaXMueSk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYWRkKGI6IFZlYzIpIHtcclxuICAgICAgICB0aGlzLnggKz0gYi54O1xyXG4gICAgICAgIHRoaXMueSArPSBiLnk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIHplcm8gKCk6IFZlYzIge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjMigwLCAwKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyByYW5kb20oKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpLCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KSlcclxuICAgIH1cclxuICAgIHN0YXRpYyBhZGQoYTogVmVjMiwgYjogVmVjMik6IFZlYzIge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjMihhLnggKyBiLngsIGEueSArIGIueSk7XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG4iLCJpbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi91dGlsJ1xyXG5cclxuY29uc3QgcG9zaXRpb25zID0gWzAsIDExMiwgMjI0LCAzMzZdO1xyXG5jb25zdCBwb3NpdGlvbnNQaG9uZSA9IFstMTIsIDcwLCAxNTEsIDIzMl07XHJcblxyXG5leHBvcnQgY2xhc3MgVGlsZSB7XHJcbiAgICBwdWJsaWMgcG9zaXRpb246IFZlYzI7XHJcbiAgICBwdWJsaWMgdmFsdWU6IG51bWJlcjtcclxuICAgIHB1YmxpYyBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICAgIHB1YmxpYyBpZCA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICBwdWJsaWMgcG9zaXRpb25zOiBudW1iZXJbXTtcclxuXHJcbiAgICBwdWJsaWMgZ2V0IHggKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueDtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgeSAoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbi55O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMyKHgsIHkpO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSAoTWF0aC5yYW5kb20oKSA+PSAwLjkgPyAyIDogMSk7XHJcbiAgICAgICAgLy8gdGhpcy52YWx1ZSA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTApICsgMTsgLy8gRm9yIHRlc3RpbmcgY3NzIGNsYXNzZXNcclxuXHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbnMgPSAod2luZG93LmlubmVyV2lkdGggPiA2MDApID8gcG9zaXRpb25zIDogcG9zaXRpb25zUGhvbmU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5zZXJ0cyB0aGUgRWxlbWVudCBpbnRvIHRoZSBET01cclxuICAgIHB1YmxpYyBkcmF3KCkge1xyXG4gICAgICAgIGNvbnN0IHJvb3Q6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyb290XCIpITtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0aWxlXCIpO1xyXG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChgdGlsZS0ke3RoaXMudmFsdWV9YCk7XHJcbiAgICAgICAgZWxlbWVudC5pbm5lclRleHQgPSBNYXRoLnBvdygyLCB0aGlzLnZhbHVlKS50b1N0cmluZygpO1xyXG5cclxuICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSBgJHt0aGlzLnBvc2l0aW9uc1t0aGlzLnBvc2l0aW9uLnhdfXB4YDtcclxuICAgICAgICBlbGVtZW50LnN0eWxlLnRvcCA9IGAke3RoaXMucG9zaXRpb25zW3RoaXMucG9zaXRpb24ueV19cHhgO1xyXG4gICAgICAgIHJvb3QuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYmVmb3JlZW5kXCIsIGVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlcyB0aGUgdGV4dCBhbmQgY2xhc3Mgb2YgdGhlIEhUTUxFbGVtZW50XHJcbiAgICBwdWJsaWMgdXBkYXRlKHJlbW92ZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgLy8gVGhlIHRpbWUgaXQgdGFrZXMgdG8gbW92ZSB0aGUgdGlsZSBpbiBtc1xyXG4gICAgICAgIGNvbnN0IGFuaW1hdGlvblRpbWUgPSAxMDA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHt0aGlzLnBvc2l0aW9uc1t0aGlzLnBvc2l0aW9uLnhdfXB4YDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7dGhpcy5wb3NpdGlvbnNbdGhpcy5wb3NpdGlvbi55XX1weGA7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc05hbWUgPSBgdGlsZSB0aWxlLSR7dGhpcy52YWx1ZX1gO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJUZXh0ID0gTWF0aC5wb3coMiwgdGhpcy52YWx1ZSkudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgaWYgKHJlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGFuaW1hdGlvblRpbWUpXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVtb3ZlcyB0aGUgSFRNTEVsZW1lbnQgZnJvbSB0aGUgRE9NXHJcbiAgICBwdWJsaWMgcmVtb3ZlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGVzIGEgbmV3IFRpbGUgZnJvbSBhIFZlYzJcclxuICAgIHN0YXRpYyBmcm9tKHBvc2l0aW9uOiBWZWMyKTogVGlsZSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUaWxlIChwb3NpdGlvbi54LCBwb3NpdGlvbi55KTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gXCIuL21vdmVcIjtcclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV4dEdyaWQoZ3JpZDogbnVtYmVyW10sIG1vdmU6IERpcmVjdGlvbik6IG51bWJlcltdIHtcclxuICAgIGNvbnN0IHRlbXAgPSAgWzAsIDAsIDAsIDAsXHJcbiAgICAgICAgMCwgMCwgMCwgMCxcclxuICAgICAgICAwLCAwLCAwLCAwLFxyXG4gICAgICAgIDAsIDAsIDAsIDAsXTtcclxuXHJcbiAgICBpZiAobW92ZSA9PSBEaXJlY3Rpb24uVXApIHtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciByb3c6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHJvdy5wdXNoKGdyaWRbaSArIDQqal0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJvdyA9IHN3aXBlUm93KHJvdyk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHRlbXBbaSArIDQqal0gPSByb3dbal07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChtb3ZlID09IERpcmVjdGlvbi5MZWZ0KSB7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcm93OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICByb3cucHVzaChncmlkWzQqaSArIGpdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3cgPSBzd2lwZVJvdyhyb3cpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wWzQqaSArIGpdID0gcm93W2pdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobW92ZSA9PSBEaXJlY3Rpb24uRG93bikge1xyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHJvdzogbnVtYmVyW10gPSBbXTtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgcm93LnB1c2goZ3JpZFtpICsgNCooMy1qKV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJvdyA9IHN3aXBlUm93KHJvdyk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHRlbXBbaSArIDQqKDMtaildID0gcm93W2pdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobW92ZSA9PSBEaXJlY3Rpb24uUmlnaHQpIHtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciByb3c6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHJvdy5wdXNoKGdyaWRbNCppICsgKDMtaildKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByb3cgPSBzd2lwZVJvdyhyb3cpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wWzQqaSArICgzLWopXSA9IHJvd1tqXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGVtcDtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzd2lwZVJvdyhyb3c6IG51bWJlcltdKTogbnVtYmVyW10ge1xyXG4gICAgbGV0IHByZXYgPSAtMTtcclxuICAgIGxldCBpID0gMDtcclxuICAgIGxldCB0ZW1wID0gWzAsIDAsIDAsIDBdO1xyXG4gICAgcm93LmZvckVhY2godmFsID0+IHtcclxuICAgICAgICBpZiAodmFsICE9IDApIHtcclxuICAgICAgICAgICAgaWYgKHByZXYgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IHZhbDtcclxuICAgICAgICAgICAgICAgIHRlbXBbaV0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAocHJldiA9PSB2YWwpIHtcclxuICAgICAgICAgICAgICAgIHRlbXBbaSAtIDFdID0gMiAqIHByZXY7XHJcbiAgICAgICAgICAgICAgICBwcmV2ID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2ID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgdGVtcFtpXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRlbXA7XHJcbn1cclxuXHJcbiIsImltcG9ydCBHYW1lIGZyb20gJy4vZ2FtZSdcclxuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnLi9tb3ZlJztcclxuaW1wb3J0IHsgZ2V0TmV4dEdyaWQgfSBmcm9tICcuL2dyaWQnO1xyXG5pbXBvcnQgeyBtb3ZlIH0gZnJvbSAnLi9tb3ZlJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQUkge1xyXG4gICAgcHVibGljIGN1cnJlbnRHcmlkOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgcHVibGljIG1heFN0ZXAgPSAzO1xyXG4gICAgcHVibGljIGJlc3RfbW92ZSA9IDA7XHJcbiAgICBwdWJsaWMgbm9kZXMgPSAwO1xyXG4gICAgcHVibGljIGJlc3RNb3ZlOiBEaXJlY3Rpb247XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yICgpIHtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcnVuKCkge1xyXG4gICAgICAgIGNvbnN0IGdhbWUgPSBHYW1lLmdldCgpO1xyXG4gICAgICAgIGNvbnN0IHRlbXBHcmlkID0gZ2FtZS5nZXRPbmVER3JpZCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEdyaWQgPSB0ZW1wR3JpZC5tYXAoeCA9PiB4KTtcclxuICAgICAgICB0aGlzLnN0YXJ0U2VhcmNoKCk7XHJcbiAgICAgICAgbW92ZSh0aGlzLmJlc3RNb3ZlKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXJ0U2VhcmNoKCkge1xyXG4gICAgICAgIHRoaXMubm9kZXMgPSAwO1xyXG4gICAgICAgIHRoaXMubWF4U3RlcCA9IDM7XHJcbiAgICAgICAgbGV0IG5vZGVzOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgIHdoaWxlKHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlcyA9IDA7XHJcbiAgICAgICAgICAgIGxldCB0MSA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaCh0aGlzLmN1cnJlbnRHcmlkLCAwKTtcclxuICAgICAgICAgICAgbm9kZXMucHVzaChwZXJmb3JtYW5jZS5ub3coKS10MSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGVzID49IDEwMDAwIHx8IHRoaXMubWF4U3RlcCA+PSA4KSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1heFN0ZXAgKz0gMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZWFyY2goZ3JpZDogbnVtYmVyW10sIHN0ZXA6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgdGhpcy5ub2RlcysrO1xyXG4gICAgICAgIGlmIChzdGVwID09IHRoaXMubWF4U3RlcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZShncmlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGJlc3RTY29yZSA9IC0xO1xyXG4gICAgICAgIGZvciAoY29uc3QgZGlyIGluIERpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoaXNOYU4oTnVtYmVyKGRpcikpKSBjb250aW51ZTtcclxuICAgICAgICAgICAgY29uc3QgbmV3R3JpZCA9IGdldE5leHRHcmlkKGdyaWQsIE51bWJlcihkaXIpKTtcclxuICAgICAgICAgICAgY29uc3Qgc2NvcmUgPSBuZXdHcmlkLnJlZHVjZSgoYWNjLCBjdXJyZW50KSA9PiBhY2MgKz0gY3VycmVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNhbWUgPSBuZXdHcmlkLmV2ZXJ5KCh2YWx1ZSwgaW5kZXgpID0+IHZhbHVlID09IGdyaWRbaW5kZXhdKTtcclxuICAgICAgICAgICAgaWYgKHNhbWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgZW1wdHlDZWxscyA9IDA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3R3JpZFtpXSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdHcmlkW2ldID0gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKytlbXB0eUNlbGxzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wICs9IHRoaXMuc2VhcmNoKG5ld0dyaWQsIHN0ZXAgKyAxKSAqIDAuOTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3R3JpZFtpXSA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgKz0gdGhpcy5zZWFyY2gobmV3R3JpZCwgc3RlcCArIDEpICogMC4xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdHcmlkW2ldID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZW1wdHlDZWxscyAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcCAvPSBlbXB0eUNlbGxzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IC0xZSsyMDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2NvcmUgKyB0ZW1wID4gYmVzdFNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmVzdFNjb3JlID0gc2NvcmUgKyB0ZW1wO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXN0TW92ZSA9IE51bWJlcihkaXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYmVzdFNjb3JlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZXN0aW1hdGUoZ3JpZDogbnVtYmVyW10pOiBudW1iZXIge1xyXG4gICAgICAgIGxldCBzdW0gPSAwO1xyXG4gICAgICAgIGxldCBwZW5hbHR5ID0gMDtcclxuICAgICAgICBsZXQgemVyb3MgPSAwO1xyXG4gICAgICAgIGZvcihsZXQgaSA9MDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGdyaWRbaV0gPT0gMCkgemVyb3MrKztcclxuICAgICAgICAgICAgc3VtICs9IGdyaWRbaV07XHJcbiAgICAgICAgICAgIGlmKGkgJSA0ICE9IDMpIHtcclxuICAgICAgICAgICAgICAgIHBlbmFsdHkgKz0gTWF0aC5hYnMoZ3JpZFtpXSAtIGdyaWRbaSArIDFdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihpIDwgMTIpIHtcclxuICAgICAgICAgICAgICAgIHBlbmFsdHkgKz0gTWF0aC5hYnMoZ3JpZFtpXSAtIGdyaWRbaSArIDRdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKHN1bSAqIDQgLSBwZW5hbHR5KSAqIDI7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi91dGlsJ1xyXG5pbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnXHJcbmltcG9ydCB7IFRpbGUgfSBmcm9tICcuL3RpbGUnXHJcblxyXG5leHBvcnQgZW51bSBEaXJlY3Rpb24ge1xyXG4gICAgVXAgPSAxLFxyXG4gICAgRG93bixcclxuICAgIExlZnQsXHJcbiAgICBSaWdodFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYmluZEtleUV2ZW50cygpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIC8qIEtleSB1cCAqL1xyXG4gICAgICAgIGlmIChldmVudC53aGljaCA9PSAzOCkge1xyXG4gICAgICAgICAgICBtb3ZlKERpcmVjdGlvbi5VcCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBLZXkgZG93biAqL1xyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LndoaWNoID09IDQwKSB7XHJcbiAgICAgICAgICAgIG1vdmUoRGlyZWN0aW9uLkRvd24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogS2V5IGxlZnQgKi9cclxuICAgICAgICBlbHNlIGlmIChldmVudC53aGljaCA9PSAzNykge1xyXG4gICAgICAgICAgICBtb3ZlKERpcmVjdGlvbi5MZWZ0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qIEtleSByaWdodCAqL1xyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LndoaWNoID09IDM5KSB7XHJcbiAgICAgICAgICAgIG1vdmUoRGlyZWN0aW9uLlJpZ2h0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY29yZVwiKSEuaW5uZXJUZXh0ID0gYFNjb3JlOiAke0dhbWUuZ2V0KCkuc2NvcmV9YDtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbW92ZShkaXJlY3Rpb246IERpcmVjdGlvbikge1xyXG4gICAgY29uc3QgZ2FtZSA9IEdhbWUuZ2V0KCk7XHJcbiAgICBsZXQgYm9hcmQgPSBnYW1lLmJvYXJkQ29weSgpO1xyXG4gICAgbGV0IHRpbGVzID0gZ2FtZS50aWxlcztcclxuICAgIGxldCBzdjogVmVjMjsgLy8gU29ydGluZyB2ZWN0b3JcclxuICAgIGxldCBtZDogVmVjMjsgLy8gTW92ZSBEaXJlY3Rpb25cclxuICAgIGxldCB2ZXJ0aWNhbDogYm9vbGVhbjsgXHJcblxyXG4gICAgLy8gQXNzaWduIHRoZSByaWdodCBkaXJlY3Rpb24gZm9yIGVhY2ggbW92ZW1lbnQgKHgsIHkpXHJcbiAgICBpZiAoZGlyZWN0aW9uID09IERpcmVjdGlvbi5VcCkge1xyXG4gICAgICAgIHN2ID0gbmV3IFZlYzIoMCwgMCk7XHJcbiAgICAgICAgbWQgPSBuZXcgVmVjMigwLCAtMSk7XHJcbiAgICAgICAgdmVydGljYWwgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZGlyZWN0aW9uID09IERpcmVjdGlvbi5Eb3duKSB7XHJcbiAgICAgICAgc3YgPSBuZXcgVmVjMigwLCAzKTtcclxuICAgICAgICBtZCA9IG5ldyBWZWMyKDAsIDEpO1xyXG4gICAgICAgIHZlcnRpY2FsID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBEaXJlY3Rpb24uTGVmdCkge1xyXG4gICAgICAgIHN2ID0gbmV3IFZlYzIoMCwgMCk7XHJcbiAgICAgICAgbWQgPSBuZXcgVmVjMigtMSwgMCk7XHJcbiAgICAgICAgdmVydGljYWwgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGVsc2UgeyAvLyBpZiAoZGlyZWN0aW9uID09IERpcmVjdGlvbi5SaWdodClcclxuICAgICAgICBzdiA9IG5ldyBWZWMyKDMsIDApO1xyXG4gICAgICAgIG1kID0gbmV3IFZlYzIoMSwgMCk7XHJcbiAgICAgICAgdmVydGljYWwgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgc286IFZlYzJbXSA9IFtdOyAvLyBTb3J0aW5nIG9yZGVyIG9mIGVhY2ggc3F1YXJlXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICBsZXQgdGVtcCA9IHN2LmNsb25lKCk7XHJcbiAgICAgICAgICAgIGlmICh2ZXJ0aWNhbCkge1xyXG4gICAgICAgICAgICAgICAgdGVtcC54ICs9IGo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wLnkgKz0gajtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzby5wdXNoKHRlbXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdi54IC09IG1kLng7XHJcbiAgICAgICAgc3YueSAtPSBtZC55O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEZXRlcm1pbmVzIGlmIGFueSB0aWxlIGhhcyBhY3R1YWxseSBtb3ZlZFxyXG4gICAgbGV0IG1vdmVkID0gZmFsc2U7XHJcblxyXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzby5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGlsZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHRpbGUgPSB0aWxlc1tpXTtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgdGlsZSdzIHBvc2l0aW9uIGlzIGVxdWFsIHRvIHRoZSBzb3J0aW5nIG9yZGVyIHZlY3RvclxyXG4gICAgICAgICAgICBpZiAodGlsZS5wb3NpdGlvbi5lcXVhbHMoc29bal0pKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcHJldiA9IHRpbGUucG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIGJvYXJkW3RpbGUueF1bdGlsZS55XSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAvLyBOZXh0IHBvc2l0aW9uIGlmIHRoZSB0aWxlIGlzIG1vdmVkIDEgc3RlcCBpbnRvIHRoZSBtb3ZlIGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgbGV0IG1vdmVUbyA9IFZlYzIuYWRkKHRpbGUucG9zaXRpb24sIG1kKTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dFZhbHVlID0gMDtcclxuICAgICAgICAgICAgICAgIGlmIChtb3ZlVG8ueCA8IDAgfHwgbW92ZVRvLnggPiAzIHx8IG1vdmVUby55IDwgMCB8fCBtb3ZlVG8ueSA+IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlVG8gPSB0aWxlLnBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IGJvYXJkW21vdmVUby54XVttb3ZlVG8ueV07XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gIG5leHQgPyBuZXh0LnZhbHVlIDogMDtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZShuZXh0VmFsdWUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnBvc2l0aW9uID0gbW92ZVRvLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVUbyA9IFZlYzIuYWRkKHRpbGUucG9zaXRpb24sIG1kKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb3ZlVG8ueCA8IDAgfHwgbW92ZVRvLnggPiAzIHx8IG1vdmVUby55IDwgMCB8fCBtb3ZlVG8ueSA+IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVUbyA9IHRpbGUucG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gYm9hcmRbbW92ZVRvLnhdW21vdmVUby55XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gIG5leHQgPyBuZXh0LnZhbHVlIDogMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dFZhbHVlID09IHRpbGUudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAgICogICB0aWxlIGlzIGJlaW5nIHJlbW92ZWRcclxuICAgICAgICAgICAgICAgICAgICAqICAgbmV4dCBpcyB0aGUgdGlsZXMgbGF0ZXIgaW4gdGhlIHNvcnRpbmcgb3JkZXIgd2l0aCB0aGUgc2FtZSB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHQgPSB0aWxlc1t0aWxlcy5maW5kSW5kZXgodCA9PiB0LnBvc2l0aW9uLmVxdWFscyhtb3ZlVG8pICYmIHQuaWQgIT0gdGlsZS5pZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQudmFsdWUgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICBnYW1lLnNjb3JlICs9IE1hdGgucG93KDIsIG5leHQudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRpbGUucG9zaXRpb24gPSBtb3ZlVG87XHJcbiAgICAgICAgICAgICAgICAgICAgYm9hcmRbbmV4dC54XVtuZXh0LnldID0gbmV4dDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIHRpbGVcclxuICAgICAgICAgICAgICAgICAgICB0aWxlLnVwZGF0ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aWxlcy5zcGxpY2UoaSwgMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGlsZS5wb3NpdGlvbi5lcXVhbHMocHJldikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJvYXJkW3RpbGUueF1bdGlsZS55XSA9IHRpbGU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aWxlLnBvc2l0aW9uLmVxdWFscyhwcmV2KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRpbGVzLmZvckVhY2godGlsZSA9PiB7XHJcbiAgICAgICAgdGlsZS51cGRhdGUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChtb3ZlZCkge1xyXG4gICAgICAgIGdhbWUuYm9hcmQgPSBib2FyZDtcclxuICAgICAgICBnYW1lLm5leHRNb3ZlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBnYW1lLnN0b3AgPSB0cnVlO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSAnLi90aWxlJ1xyXG5pbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi91dGlsJztcclxuaW1wb3J0IEFJIGZyb20gJy4vYWknXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcclxuICAgIC8qIFNpbmdsZVRvbiBzZXR1cCAqL1xyXG4gICAgLy8gKysrKysrKysrKysrKysrKysrKysrKysrK1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEdhbWU7XHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgcHVibGljIHN0YXRpYyBnZXQoKSB7XHJcbiAgICAgICAgaWYgKCFHYW1lLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIEdhbWUuaW5zdGFuY2UgPSBuZXcgR2FtZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gR2FtZS5pbnN0YW5jZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gU3RhdGljIE1ldGhvZHNcclxuICAgIHB1YmxpYyBzdGF0aWMgbmV3R2FtZSgpIHtcclxuICAgICAgICBjb25zdCBnYW1lID0gdGhpcy5pbnN0YW5jZTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbGUgPSBnYW1lLmJvYXJkW2ldW2pdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBnYW1lLmJvYXJkW2ldW2pdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aWxlLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByYW5kb20xID0gVmVjMi5yYW5kb20oKTtcclxuICAgICAgICBsZXQgcmFuZG9tMiA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSByYW5kb20gcG9zaXRpb25zIGFyZW4ndCB0aGUgc2FtZVxyXG4gICAgICAgIHdoaWxlKHJhbmRvbTEuZXF1YWxzKHJhbmRvbTIpKSB7XHJcbiAgICAgICAgICAgIHJhbmRvbTIgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHRpbGUxID0gVGlsZS5mcm9tKHJhbmRvbTEpLmRyYXcoKTtcclxuICAgICAgICBsZXQgdGlsZTIgPSBUaWxlLmZyb20ocmFuZG9tMikuZHJhdygpO1xyXG5cclxuICAgICAgICAvLyBJbnNlcnQgdGhlIHRpbGVzIGludG8gdGhlIGdhbWUgYm9hcmRcclxuICAgICAgICBnYW1lLmJvYXJkW3RpbGUxLnhdW3RpbGUxLnldID0gdGlsZTE7XHJcbiAgICAgICAgZ2FtZS5ib2FyZFt0aWxlMi54XVt0aWxlMi55XSA9IHRpbGUyO1xyXG4gICAgfVxyXG4gICAgLy8gKysrKysrKysrKysrKysrKysrKysrKysrK1xyXG4gICAgcHVibGljIGFpOiBBSSA9IG5ldyBBSSgpO1xyXG4gICAgcHVibGljIHN0b3A6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHB1YmxpYyBmYXN0OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgc2NvcmU6IG51bWJlciA9IDA7XHJcblxyXG4gICAgLy8gSW5zdGFuY2UgbWV0aG9kc1xyXG4gICAgcHVibGljIGJvYXJkOiAoVGlsZSB8IG51bGwpW11bXSA9IFtbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF0sIFtudWxsLCBudWxsLCBudWxsLCBudWxsXSwgW251bGwsIG51bGwsIG51bGwsIG51bGxdLCBbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF1dO1xyXG4gICAgcHVibGljIGJvYXJkQ29weSgpOiAoVGlsZSB8IG51bGwpW11bXSB7XHJcbiAgICAgICAgbGV0IGFycjogKFRpbGUgfCBudWxsKVtdW10gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgaW5zaWRlID0gdGhpcy5ib2FyZFtpXS5tYXAoeCA9PiB4KTtcclxuICAgICAgICAgICAgYXJyLnB1c2goaW5zaWRlKTtcclxuICAgICAgICB9ICAgIFxyXG4gICAgICAgIHJldHVybiBhcnI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9ncyB0aGUgZ2FtZSBib2FyZCBsaWtlIHRoZSB3YXkgaXQgYXBwZWFycyBvbiBzY3JlZW5cclxuICAgIHB1YmxpYyBsb2dCb2FyZChiPzogKFRpbGUgfCBudWxsKVtdW10pIHtcclxuICAgICAgICBsZXQgZnJvbSA9IGIgfHwgdGhpcy5ib2FyZDtcclxuICAgICAgICBsZXQgYm9hcmRTdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBzdHJpbmc6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGlsZSA9IGZyb21bal1baV07XHJcbiAgICAgICAgICAgICAgICBpZiAodGlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZy5wdXNoKE1hdGgucG93KDIsIHRpbGUudmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Ugc3RyaW5nLnB1c2goMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHN0ciA9IHN0cmluZy5qb2luKFwiXFx0XCIpO1xyXG4gICAgICAgICAgICBib2FyZFN0cmluZyArPSBzdHI7XHJcbiAgICAgICAgICAgIGJvYXJkU3RyaW5nICs9IFwiXFxuXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGJvYXJkU3RyaW5nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgdGhlIG9uIHRoZSBib2FyZFxyXG4gICAgcHVibGljIGdldCB0aWxlcyAoKTogVGlsZVtdIHtcclxuICAgICAgICBsZXQgbGlzdDogVGlsZVtdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA0OyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCB0aWxlID0gdGhpcy5ib2FyZFtpXVtqXTtcclxuICAgICAgICAgICAgICAgIGlmICh0aWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKHRpbGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgbmV4dE1vdmUodGltZSA9IDEwMCkge1xyXG4gICAgICAgIGxldCBwb3MgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgICAgIHdoaWxlKHRoaXMudGlsZXMuc29tZSh0aWxlID0+IHRpbGUucG9zaXRpb24uZXF1YWxzKHBvcykpKSB7XHJcbiAgICAgICAgICAgIHBvcyA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHRpbGUgPSBUaWxlLmZyb20ocG9zKS5kcmF3KCk7XHJcbiAgICAgICAgdGhpcy5ib2FyZFt0aWxlLnhdW3RpbGUueV0gPSB0aWxlO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRPbmVER3JpZCgpOiBudW1iZXJbXSB7XHJcbiAgICAgICAgbGV0IGdyaWQ6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCA0OyB4KyspIHtcclxuICAgICAgICAgICAgZm9yKGxldCB5ID0gMDsgeSA8IDQ7IHkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGlsZSA9IHRoaXMuYm9hcmRbeV1beF07XHJcbiAgICAgICAgICAgICAgICBpZiAodGlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWQucHVzaChNYXRoLnBvdygyLCB0aWxlLnZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkLnB1c2goMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGdyaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHByZXZUaW1lOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIHB1YmxpYyBzdGFydEFJKCkge1xyXG4gICAgICAgIGxldCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG4gICAgICAgIHRoaXMuYWkucnVuKCk7XHJcbiAgICAgICAgbGV0IHQxID0gcGVyZm9ybWFuY2Uubm93KCk7IFxyXG4gICAgICAgIGlmICh0aGlzLnN0b3ApIHtcclxuICAgICAgICAgICAgdGhpcy5zdG9wID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY29yZVwiKSEuaW5uZXJUZXh0ID0gYFNjb3JlOiAke3RoaXMuc2NvcmV9YDtcclxuICAgICAgICBjb25zdCB0aW1lID0gMTAwIC0gKHQxIC0gdDApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghdGhpcy5mYXN0KSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBSSgpO1xyXG4gICAgICAgICAgICB9LCB0aW1lIDwgMCA/IDAgOiB0aW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QUkoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZXdHYW1lKCkge1xyXG4gICAgICAgIHRoaXMudGlsZXMuZm9yRWFjaCh0aWxlID0+IHtcclxuICAgICAgICAgICAgdGlsZS5yZW1vdmUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgeCAgPSAwOyB4IDwgNDsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgNDsgeSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3hdW3ldID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHJhbmRvbTEgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgICAgIGxldCByYW5kb20yID0gVmVjMi5yYW5kb20oKTtcclxuICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHJhbmRvbSBwb3NpdGlvbnMgYXJlbid0IHRoZSBzYW1lXHJcbiAgICAgICAgd2hpbGUocmFuZG9tMS5lcXVhbHMocmFuZG9tMikpIHtcclxuICAgICAgICAgICAgcmFuZG9tMiA9IFZlYzIucmFuZG9tKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdGlsZTEgPSBUaWxlLmZyb20ocmFuZG9tMSkuZHJhdygpO1xyXG4gICAgICAgIGxldCB0aWxlMiA9IFRpbGUuZnJvbShyYW5kb20yKS5kcmF3KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gbGV0IHRpbGUxID0gbmV3IFRpbGUoMywgMSkuZHJhdygpO1xyXG4gICAgICAgIC8vIGxldCB0aWxlMiA9IG5ldyBUaWxlKDAsIDMpLmRyYXcoKTtcclxuXHJcbiAgICAgICAgLy8gSW5zZXJ0IHRoZSB0aWxlcyBpbnRvIHRoZSBnYW1lIGJvYXJkXHJcbiAgICAgICAgdGhpcy5ib2FyZFt0aWxlMS54XVt0aWxlMS55XSA9IHRpbGUxO1xyXG4gICAgICAgIHRoaXMuYm9hcmRbdGlsZTIueF1bdGlsZTIueV0gPSB0aWxlMjtcclxuXHJcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY29yZVwiKSEuaW5uZXJIVE1MID0gXCJTY29yZTogMFwiO1xyXG4gICAgfVxyXG4gICAgXHJcbn0iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSAnLi90aWxlJ1xyXG5pbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi91dGlsJ1xyXG5pbXBvcnQgeyBiaW5kS2V5RXZlbnRzIH0gZnJvbSAnLi9tb3ZlJ1xyXG5pbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnO1xyXG5cclxuLy8gQWRkcyB0d28gcmFuZG9tIHRpbGVzIHRvIHRoZSBnYW1lIGJvYXJkIGFuZCBpbnRvIHRoZSBET01cclxuZXhwb3J0IGZ1bmN0aW9uIHNldHVwKCkge1xyXG4gICAgY29uc3Qgcm9vdDogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJvb3RcIikhO1xyXG4gICAgbGV0IHJhbmRvbTEgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgbGV0IHJhbmRvbTIgPSBWZWMyLnJhbmRvbSgpO1xyXG4gICAgLy8gTWFrZSBzdXJlIHRoZSByYW5kb20gcG9zaXRpb25zIGFyZW4ndCB0aGUgc2FtZVxyXG4gICAgd2hpbGUocmFuZG9tMS5lcXVhbHMocmFuZG9tMikpIHtcclxuICAgICAgICByYW5kb20yID0gVmVjMi5yYW5kb20oKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgdGlsZTEgPSBUaWxlLmZyb20ocmFuZG9tMSkuZHJhdygpO1xyXG4gICAgbGV0IHRpbGUyID0gVGlsZS5mcm9tKHJhbmRvbTIpLmRyYXcoKTtcclxuICAgIFxyXG4gICAgLy8gbGV0IHRpbGUxID0gbmV3IFRpbGUoMywgMSkuZHJhdygpO1xyXG4gICAgLy8gbGV0IHRpbGUyID0gbmV3IFRpbGUoMCwgMykuZHJhdygpO1xyXG5cclxuICAgIC8vIEluc2VydCB0aGUgdGlsZXMgaW50byB0aGUgZ2FtZSBib2FyZFxyXG4gICAgY29uc3QgZ2FtZSA9IEdhbWUuZ2V0KCk7XHJcbiAgICBnYW1lLmJvYXJkW3RpbGUxLnhdW3RpbGUxLnldID0gdGlsZTE7XHJcbiAgICBnYW1lLmJvYXJkW3RpbGUyLnhdW3RpbGUyLnldID0gdGlsZTI7XHJcblxyXG4gICAgYmluZEtleUV2ZW50cygpO1xyXG59IiwiaW1wb3J0IHsgc2V0dXAgfSBmcm9tICcuL3NldHVwJ1xyXG5pbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnXHJcbmltcG9ydCB7IHN3aXBlUm93IH0gZnJvbSAnLi9ncmlkJ1xyXG5cclxuLy9AdHMtaWdub3JlXHJcbndpbmRvdy5HYW1lID0gR2FtZTtcclxuXHJcblxyXG4oKCkgPT4ge1xyXG4gICAgc2V0dXAoKTtcclxufSkoKTsiXSwic291cmNlUm9vdCI6IiJ9
!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e){this.x=t,this.y=e}get coord(){return`${this.x}:${this.y}`}get length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}static get zero(){return new s(0,0)}distance(t){return s.sub(this,t).length}equals(t){return this.x==t.x&&this.y==t.y}add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}static add(t,e){return new s(t.x+e.x,t.y+e.y)}static sub(t,e){return new s(t.x-e.x,t.y-e.y)}}e.Point=s,e.h=["manhattan","octile","eucledian","chebyshev"]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Graph=class{constructor(t,e,i,s=1){this.x=t,this.y=e,this.coord=`${t}:${e}`,this.solid=i,this.movementCost=s}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(3),r=i(0);e.Line=class{constructor(t,e){this.p1=t,this.p2=e,this.segment=new s.Vec2(t,e),this.update()}update(){let t,e;this.p1.x>this.p2.x?(t=this.p2,e=this.p1):(t=this.p1,e=this.p2),this.a=e.y-t.y,this.b=t.x-e.x,this.c=this.a*e.x+this.b*e.y}perpendicular(){let t=new s.Vec2(this.p1,this.p2).mid,e=-this.b*t.x+this.a*t.y;return{a:-this.b,b:this.a,c:e}}bisectIntersect(t){let e=this.perpendicular(),i=t.perpendicular(),s=e.a*i.b-i.a*e.b;if(0==s)return new r.Point(-1,-1);let o=(i.b*e.c-e.b*i.c)/s,n=(e.a*i.c-i.a*e.c)/s;return new r.Point(o,n)}intersect(t){let e=this.a*t.b-t.a*this.b;if(0==e)return new r.Point(-1,-1);let i=(t.b*this.c-this.b*t.c)/e,s=(this.a*t.c-t.a*this.c)/e;return new r.Point(i,s)}on(t){if(0==this.b)return this.p1.x==t.x;let e=this.c/this.b-this.a/this.b*t.x;return Math.fround(e)===Math.fround(t.y)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),r=i(2);class o{constructor(t,e){this.p1=t,this.p2=e}get length(){return this.p1.distance(this.p2)}get mid(){let t=(this.p1.x+this.p2.x)/2,e=(this.p1.y+this.p2.y)/2;return new s.Point(t,e)}equals(t){return this.p1.equals(t.p1)&&this.p2.equals(t.p2)}onSegment(...t){let e,i,s,r;if(t.length>1?(e=t[0],i=t[1],s=t[2],r=t[3]):(e=this.p1,i=t[0],s=this.p2,r=t[1]),r){if(i.x<Math.max(e.x,s.x)&&i.x>Math.min(e.x,s.x)&&i.y<Math.max(e.y,s.y)&&i.y>Math.min(e.y,s.y))return!0}else if(i.x<=Math.max(e.x,s.x)&&i.x>=Math.min(e.x,s.x)&&i.y<=Math.max(e.y,s.y)&&i.y>=Math.min(e.y,s.y))return!0;return!1}intersect(t,e=!1){let i=this.p1,s=this.p2,o=t.p1,n=t.p2;const h=(t,e,i)=>{let s=(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y);return 0==s?0:s>0?1:2};let a=h(i,s,o),c=h(i,s,n),l=h(o,n,i),u=h(o,n,s);if(a!=c&&l!=u){let h=new r.Line(this.p1,this.p2),a=new r.Line(t.p1,t.p2),c=h.intersect(a);return(!e||!(i.equals(c)||o.equals(c)||s.equals(c)||n.equals(c)))&&(h.on(c)&&a.on(c))}return!(0!=a||!this.onSegment(i,o,s,e))||(!(0!=c||!this.onSegment(i,n,s,e))||(!(0!=l||!this.onSegment(o,i,n,e))||!(0!=u||!this.onSegment(o,s,n,e))))}static fromZero(t){return new o(s.Point.zero,t)}}e.Vec2=o},function(t,e,i){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),s(i(2)),s(i(3))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(6),r=i(2);class o extends s.Polygon{constructor(t){if(3!=t.length)throw new Error("Triangle with not 3 vertices was created!");t.sort((t,e)=>t.length-e.length),super(t,"triangle")}get circumcircle(){let t=this.vertices[0],e=this.vertices[1],i=this.vertices[2],s=new r.Line(t,e),o=new r.Line(e,i),n=s.bisectIntersect(o),h=n.distance(t);return{center:n,radius:h}}insideCircumcircle(t){const{center:e,radius:i}=this.circumcircle;return t.distance(e)<=i}}e.Triangle=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),r=i(3);e.Polygon=class{constructor(t,e="mesh"){this.vertices=t,this.type=e}equals(t){if(t.vertices.length!=this.vertices.length)return!1;return this.vertices.map(t=>t).sort((t,e)=>t.length-e.length).map(t=>t.coord).toString()===t.vertices.map(t=>t).sort((t,e)=>t.length-e.length).map(t=>t.coord).toString()}containsEdge(t){let e=this.edges,i=!1;return e.forEach(e=>{e.p1.x==t.p1.x&&e.p1.y==t.p1.y&&e.p2.x==t.p2.x&&e.p2.y==t.p2.y&&(i=!0)}),i}get sidePoints(){let t=[];for(let e=1;e<this.vertices.length;e++){let i=new s.Point((this.vertices[e-1].x+this.vertices[e].x)/2,(this.vertices[e-1].y+this.vertices[e].y)/2);t.push(i)}return t.push(new s.Point((this.vertices[0].x+this.vertices[this.vertices.length-1].x)/2,(this.vertices[0].y+this.vertices[this.vertices.length-1].y)/2)),t}get boundingBox(){let t=this.vertices.map(t=>t.x),e=this.vertices.map(t=>t.y);return[new s.Point(Math.min(...t),Math.min(...e)),new s.Point(Math.max(...t),Math.max(...e))]}get edges(){let t=[];for(let e=0;e<this.vertices.length-1;e++)t.push(new r.Vec2(this.vertices[e],this.vertices[e+1]));return t.push(new r.Vec2(this.vertices[0],this.vertices[this.vertices.length-1])),t}get center(){let t=this.vertices.map(t=>t.x).reduce((t,e)=>t+e),e=this.vertices.map(t=>t.y).reduce((t,e)=>t+e);return new s.Point(t/this.vertices.length,e/this.vertices.length)}neigbourVertices(t){let e=[];return 0==t?(e.push(this.vertices[this.vertices.length-1]),e.push(this.vertices[1])):t==this.vertices.length-1?(e.push(this.vertices[t-1]),e.push(this.vertices[0])):(e.push(this.vertices[t-1]),e.push(this.vertices[t+1])),e}toPath(){let t=`M${this.vertices[0].x},${this.vertices[0].y}`;for(let e=1;e<this.vertices.length;e++)t+=`L${this.vertices[e].x},${this.vertices[e].y}`;return t+="Z",t}overlap(t){return!!t.vertices.every(t=>this.inside(t))||!!t.edges.some(t=>this.edges.some(e=>e.intersect(t,!0)))}inside(t,e=!1){const i=(t,e,i)=>e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y),r=(t,e,i)=>{let s=(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y);return 0==s?0:s>0?1:2},o=(t,e,s,o)=>{let n=r(t,e,s),h=r(t,e,o),a=r(s,o,t),c=r(s,o,e);return n!=h&&a!=c||(!(0!=n||!i(t,s,e))||(!(0!=h||!i(t,o,e))||(!(0!=a||!i(s,t,o))||!(0!=c||!i(s,e,o)))))};let n=new s.Point(9999999999,t.y);e&&(n=new s.Point(1/0,t.y));let h=0,a=0;do{let e=(a+1)%this.vertices.length;if(o(this.vertices[a],this.vertices[e],t,n)){if(0==r(this.vertices[a],t,this.vertices[e]))return i(this.vertices[a],t,this.vertices[e]);h++}a=e}while(0!=a);return h%2==1}containTwo(t){let e=[];e.push(...t),e.push(...this.vertices);let i=new Set(e);return e.length-i.size==2}}},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),r=0;for(e=0;e<i;e++)for(var o=arguments[e],n=0,h=o.length;n<h;n++,r++)s[r]=o[n];return s},r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=r(i(8)),n=Raphael("grid-container",window.innerWidth-250,window.innerHeight),h=[new o.Point(50,50),new o.Point(window.innerWidth-300,50),new o.Point(window.innerWidth-300,window.innerHeight-50),new o.Point(50,window.innerHeight-50)],a=new o.Shapes.Polygon(h);n.path(a.toPath()).attr({fill:"#d8d8c8",stroke:"#938181","stroke-width":3});var c,l,u,d=new o.AStar,p=new o.Point(100,100),y=n.circle(100,100,8).attr({fill:"green",stroke:"black"}),g=new o.Point(500,500),f=n.circle(500,500,8).attr({fill:"red",stroke:"black"}),x=[],v="none",m=[],b=[],w=[],P=[],M=document.getElementById("addShape"),_=document.getElementById("generateMap"),E=document.getElementById("clearMap");M.onclick=function(t){v="add shape",m.length=0},_.onclick=function(t){v="set start";var e=(u=new o.MeshGrid(x,a.vertices)).generateMap();w.forEach((function(t){return t.remove()})),w.length=0,e.triangulation.forEach((function(t){var e=n.path(t.toPath());e.attr({stroke:"blue"}),w.push(e)})),P.forEach((function(t){return t.remove()})),P.length=0,e.points.forEach((function(t){var e=n.circle(t.x,t.y,3);e.attr({fill:"red",stroke:"black"}),P.push(e)}))},E.onclick=function(t){v="none",w.forEach((function(t){return t.remove()})),P.forEach((function(t){return t.remove()})),c&&c.remove(),b.forEach((function(t){return t.remove()})),b.length=0,x.length=0},n.canvas.onclick=function(t){"add shape"==v?m.push(new o.Point(t.x,t.y)):"set start"==v&&function(t,e){c&&c.remove();y.remove(),p.x=t,p.y=e;var i=d.findPathMesh(p,g,u),s="M";i.path.forEach((function(t){s+=t.x+" "+t.y+"L"})),y=n.circle(p.x,p.y,8).attr({fill:"green",stroke:"black"}),(c=n.path(s)).attr({stroke:"purple","stroke-width":3})}(t.x,t.y)},n.canvas.oncontextmenu=function(t){t.preventDefault(),"set start"==v&&function(t,e){c&&c.remove();f.remove(),g.x=t,g.y=e;var i=d.findPathMesh(p,g,u),s="M";i.path.forEach((function(t){s+=t.x+" "+t.y+"L"})),f=n.circle(g.x,g.y,8).attr({fill:"red",stroke:"black"}),(c=n.path(s)).attr({stroke:"purple","stroke-width":3})}(t.x,t.y)},n.canvas.onmousemove=function(t){if("add shape"==v&&0!=m.length){void 0!==l&&l.remove();for(var e="M"+m[0].x+","+m[0].y,i=1;i<m.length;i++)e+="L"+m[i].x+","+m[i].y;e+="L"+t.x+","+t.y,l=n.path(e)}},window.addEventListener("keyup",(function(t){if(13===t.which){if(m.length<3)return;v="none",l.remove();var e=new o.Shapes.Polygon(s(m));x.push(e);var i=function(t){var e=n.path(t.toPath());return e.attr({fill:"white",stroke:"#938181","stroke-width":3}),e}(e);b.push(i)}}))},function(t,e,i){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0}),s(i(9)),s(i(1)),s(i(0)),s(i(10)),s(i(11)),s(i(12)),s(i(13)),e.Shapes=r(i(14)),e.Math=r(i(4))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.Grid=class{constructor(t,e){this.matrix=[],this.map=[],this.width=t,this.height=e,this.matrix=new Array(e).fill(new Array(t).fill(0)),this.fill(this.matrix)}get(t,e){return this.map[e][t]}set(t,e,i){this.map[e][t]=i}setSolid(t,e,i){this.matrix[e][t]=Number(i),this.map[e][t].solid=i}fill(t){let e=0==this.map.length;for(let i=0;i<t.length;i++){e?this.map.push([]):this.map[i].length=0;for(let e=0;e<t[i].length;e++){let r=new s.Graph(e,i,Boolean(t[i][e]));this.map[i].push(r)}}}random(t=.7){return this.matrix.forEach((e,i)=>{e.forEach((e,s)=>{let r=Number(Math.random()>t);r?this.setSolid(s,i,!0):this.setSolid(s,i,!1),this.matrix[i][s]=r})}),this.matrix}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),r=i(4);e.AStar=class{constructor(t={}){this.diagonalCost=1,this.diagonal=t.diagonal||!1,this.heuristic=t.heuristic||"manhattan",this.passDiagonal=t.passDiagonal||!1,this.bidirectional=t.bidirectional||!1,t.smoothenPath&&(this.diagonalCost=Math.SQRT2)}findPath(t,e,i){if(this.bidirectional)return this.findPathbs(t,e,i);let s=i.get(t.x,t.y),r=[s],o=[],n={},h={},a={},c=[],l=`${t.x}:${t.y}`,u=`${e.x}:${e.y}`;for(n[l]=0,h[l]=0;r.length>0;){if(o.push(s),s=r.pop(),s.coord===u){let e=[],n=[];for(;s.coord!=l;)e.push({x:s.x,y:s.y}),n.push(s),s=a[s.coord];e.push({x:t.x,y:t.y}),n.push(i.get(t.x,t.y)),e.reverse(),n.reverse();let h=e.length;return{path:e,nodes:n,open:r,closed:o,length:h}}c=this.getNeighbours(s,u,i),c.forEach((t,i)=>{let o=t[0],c=h[s.coord]+o.movementCost+(t[1]>3?this.diagonalCost-1:0);if(void 0===h[o.coord]||c<h[o.coord]){let t=this.hvalue(e,o);h[o.coord]=c,n[o.coord]=c+t,a[o.coord]=s,r.insertSorted(o,(t,e)=>n[e.coord]-n[t.coord])}})}return{path:[],nodes:[],open:r,closed:o,length:0}}findPathMesh(t,e,i){this.heuristic="octile";let o=Object.keys(i.map).map(t=>i.map[t].node).sort((e,i)=>this.hvalue(t,e)-this.hvalue(t,i))[0],n=Object.keys(i.map).map(t=>i.map[t].node).sort((t,i)=>this.hvalue(e,t)-this.hvalue(e,i))[0],h=i.map[o.coord].node,a=[h],c=[],l={},u={},d={},p=[];for(l[o.coord]=0,u[o.coord]=0;a.length>0;){if(c.push(h),h=a.pop(),h.coord===n.coord){let n=[];for(;h.coord!=o.coord;)n.push(h),h=d[h.coord];n.push(o),n.push(t),n.splice(0,0,e);let l=void 0;for(let t=0;t<n.length&&(h=new s.Point(n[t].x,n[t].y),!(t+2>=n.length));t++){let e=new s.Point(n[t+2].x,n[t+2].y),o=new r.Vec2(h,e);if(i.meshes.every(t=>t.edges.every(e=>!e.intersect(o,!0)&&!t.sidePoints.some(t=>t.equals(o.p1)||t.equals(o.p2))))){let s=n[t+1];if(null!=l&&i.meshes.some(t=>t.vertices.some(t=>t.equals(s))||t.sidePoints.some(t=>t.equals(s)))&&i.meshes.some(t=>t.vertices.some(t=>t.equals(e))||t.sidePoints.some(t=>t.equals(e)))){l=h;continue}l=n.splice(t+1,1)[0],t--}else l=h}n.push(t),n.reverse(),n.push(e),i.meshes.every(i=>i.edges.every(i=>!i.intersect(new r.Vec2(t,e),!0)))&&(n=[t,e]);let u=n.length;return{path:n,open:a,closed:c,length:u}}p=i.get(h).neighbours,p.forEach(t=>{let e=u[h.coord]+t.movementCost;if(void 0===u[t.coord]||e<u[t.coord]){let i=this.hvalue(n,t);u[t.coord]=e,l[t.coord]=e+i,d[t.coord]=h,a.insertSorted(t,(t,e)=>l[e.coord]-l[t.coord])}})}return{path:[],nodes:[],open:a,closed:c,length:0}}findPathbs(t,e,i){let s=[i.get(t.x,t.y),i.get(e.x,e.y)],r=[[],[]],o=[],n=[{},{}],h=[{},{}],a=[{},{}],c=`${t.x}:${t.y}`,l=`${e.x}:${e.y}`,u=[[],[]];for(n[0][c]=0,n[1][l]=0,h[0][c]=0,h[1][l]=0,r=[[i.get(t.x,t.y)],[i.get(e.x,e.y)]];r[0].length>0&&r[1].length>0;){if(o.push(s[0],s[1]),s=[r[0].pop(),r[1].pop()],void 0!==a[0][s[1].coord]||void 0!==a[1][s[0].coord]){let t=Number(void 0!==a[0][s[1].coord]),e=[],n=[],h={x:s[t].x,y:s[t].y};for(;s[t];)e.push({x:s[t].x,y:s[t].y}),s[t]=a[1-t][s[t].coord];for(s[1-t]=i.get(h.x,h.y);s[1-t];)n.push({x:s[1-t].x,y:s[1-t].y}),s[1-t]=a[t][s[1-t].coord];e.reverse(),e.pop(),e.push(...n);let c=[];return c.push(...r[0]),c.push(...r[1]),{path:e,nodes:[],open:c,closed:o,length:0}}u=[this.getNeighbours(s[0],l,i),this.getNeighbours(s[1],c,i)],u.forEach((t,e)=>{t.forEach(t=>{let i=t[0],o=h[e][s[e].coord]+i.movementCost+(t[1]>3?this.diagonalCost-1:0);if(void 0===h[e][i.coord]||o<h[e][i.coord]){let t=this.hvalue(s[1-e],i);h[e][i.coord]=o,n[e][i.coord]=o+t+h[1-e][s[1-e].coord],a[e][i.coord]=s[e],r[e].insertSorted(i,(t,i)=>n[e][i.coord]-n[e][t.coord])}})})}let d=[];return d.push(...r[0]),d.push(...r[1]),{path:[],nodes:[],open:d,closed:o,length:0}}hvalue(t,e){let i=0;if("octile"==this.heuristic){let s=1,r=Math.SQRT2,o=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);i=s*(o+n)+(r-2*s)*Math.min(o,n)}else if("eucledian"==this.heuristic){let s=1,r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);i=s*Math.sqrt(r*r+o*o)}else if("chebyshev"==this.heuristic){let s=1,r=1,o=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);i=s*(o+n)+(r-2*s)*Math.min(o,n)}else i=Math.abs(t.x-e.x)+Math.abs(t.y-e.y);return i}getNeighbours(t,e,i){let s=[],r=[[1,0],[0,1],[-1,0],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]];for(let o=0;o<(this.diagonal?8:4);o++){if(t.x+r[o][0]>i.width-1||t.x+r[o][0]<0)continue;if(t.y+r[o][1]>i.height-1||t.y+r[o][1]<0)continue;if(!this.passDiagonal&&o>3&&i.get(t.x+r[o][0],t.y).solid&&i.get(t.x,t.y+r[o][1]).solid)continue;let n=i.get(t.x+r[o][0],t.y+r[o][1]);n.solid&&n.coord!==e||s.push([n,o])}return s}},Array.prototype.insertSorted=function(t,e){if(this.length<1||e(t,this[this.length-1])>=0)return this.push(t),this;for(var i=this.length-2;i>=0;i--)if(e(t,this[i])>=0)return this.splice(i+1,0,t),this;return this.splice(0,0,t),this}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BFS=class{constructor(t={}){this.diagonal=t.diagonal||!1,this.heuristic=t.heuristic||"manhattan",this.passDiagonal=t.passDiagonal||!1,this.bidirectional=t.bidirectional||!1}findPath(t,e,i){if(this.bidirectional)return this.findPathbs(t,e,i);let s=i.get(t.x,t.y),r=[s],o=[],n={},h={},a=[],c=`${t.x}:${t.y}`,l=`${e.x}:${e.y}`;for(h[c]=0;r.length>0;){if(o.push(s),s=r.pop(),s.coord===l){let e=[],h=[];for(;s.coord!=c;)e.push({x:s.x,y:s.y}),h.push(s),s=n[s.coord];e.push({x:t.x,y:t.y}),h.push(i.get(t.x,t.y)),e.reverse(),h.reverse();let a=e.length;return{path:e,nodes:h,open:r,closed:o,length:a}}a=this.getNeighbours(s,l,i),a.forEach((t,i)=>{let o=t[0],a=this.hvalue(e,o);(void 0===h[o.coord]||a<h[o.coord])&&(h[o.coord]=a,n[o.coord]=s,r.insertSorted(o,(t,e)=>h[e.coord]-h[t.coord]))})}return{path:[],nodes:[],open:r,closed:o,length:0}}findPathbs(t,e,i){let s=[i.get(t.x,t.y),i.get(e.x,e.y)],r=[[],[]],o=[],n=[{},{}],h=[{},{}],a=[[],[]],c=`${t.x}:${t.y}`,l=`${e.x}:${e.y}`;for(n[0][c]=0,n[1][l]=0,r=[[i.get(t.x,t.y)],[i.get(e.x,e.y)]];r[0].length>0&&r[1].length>0;){if(o.push(s[0],s[1]),s=[r[0].pop(),r[1].pop()],void 0!==h[0][s[1].coord]||void 0!==h[1][s[0].coord]){let t=Number(void 0!==h[0][s[1].coord]),e=[],n=[],a={x:s[t].x,y:s[t].y};for(;s[t];)e.push({x:s[t].x,y:s[t].y}),s[t]=h[1-t][s[t].coord];for(s[1-t]=i.get(a.x,a.y);s[1-t];)n.push({x:s[1-t].x,y:s[1-t].y}),s[1-t]=h[t][s[1-t].coord];e.reverse(),e.push(...n);let c=[];return c.push(...r[0]),c.push(...r[1]),{path:e,nodes:[],open:c,closed:o,length:0}}a=[this.getNeighbours(s[0],l,i),this.getNeighbours(s[1],c,i)],a.forEach((i,o)=>{i.forEach(i=>{let a=i[0],c=this.hvalue(0==o?e:t,a);(void 0===n[o][a.coord]||c<n[o][a.coord])&&(n[o][a.coord]=c,h[o][a.coord]=s[o],r[o].insertSorted(a,(t,e)=>n[o][e.coord]-n[o][t.coord]))})})}let u=[];return u.push(...r[0]),u.push(...r[1]),{path:[],nodes:[],open:u,closed:o,length:0}}hvalue(t,e){let i=0;if("octile"==this.heuristic){let s=1,r=Math.SQRT2,o=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);i=s*(o+n)+(r-2*s)*Math.min(o,n)}else if("eucledian"==this.heuristic){let s=1,r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);i=s*Math.sqrt(r*r+o*o)}else if("chebyshev"==this.heuristic){let s=1,r=1,o=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);i=s*(o+n)+(r-2*s)*Math.min(o,n)}else i=Math.abs(t.x-e.x)+Math.abs(t.y-e.y);return i}getNeighbours(t,e,i){let s=[],r=[[1,0],[0,1],[-1,0],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]];for(let o=0;o<(this.diagonal?8:4);o++){if(t.x+r[o][0]>i.width-1||t.x+r[o][0]<0)continue;if(t.y+r[o][1]>i.height-1||t.y+r[o][1]<0)continue;if(!this.passDiagonal&&o>3&&i.get(t.x+r[o][0],t.y).solid&&i.get(t.x,t.y+r[o][1]).solid)continue;let n=i.get(t.x+r[o][0],t.y+r[o][1]);n.solid&&n.coord!==e||s.push([n,o])}return s}},Array.prototype.insertSorted=function(t,e){if(this.length<1||e(t,this[this.length-1])>=0)return this.push(t),this;for(var i=this.length-2;i>=0;i--)if(e(t,this[i])>=0)return this.splice(i+1,0,t),this;return this.splice(0,0,t),this}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Dijkstra=class{constructor(t={}){this.diagonalCost=1,this.diagonal=t.diagonal||!1,this.passDiagonal=t.passDiagonal||!1,t.smoothenPath&&(this.diagonalCost=Math.SQRT2),this.bidirectional=t.bidirectional||!1}findPath(t,e,i){if(this.bidirectional)return this.findPathbs(t,e,i);let s=i.get(t.x,t.y),r=[s],o=[],n={},h={},a=[],c=`${t.x}:${t.y}`,l=`${e.x}:${e.y}`;for(h[c]=0;r.length>0;){if(o.push(s),s=r.pop(),s.coord===l){let e=[],h=[];for(;s.coord!=c;)e.push({x:s.x,y:s.y}),h.push(s),s=n[s.coord];e.push({x:t.x,y:t.y}),h.push(i.get(t.x,t.y)),e.reverse(),h.reverse();let a=e.length;return{path:e,nodes:h,open:r,closed:o,length:a}}a=this.getNeighbours(s,l,i),a.forEach(t=>{let e=t[0],i=h[s.coord]+e.movementCost+(t[1]>3?this.diagonalCost-1:0);(void 0===h[e.coord]||i<h[e.coord])&&(h[e.coord]=i,n[e.coord]=s,r.insertSorted(e,(t,e)=>h[e.coord]-h[t.coord]))})}return{path:[],nodes:[],open:r,closed:o,length:0}}findPathbs(t,e,i){let s=[i.get(t.x,t.y),i.get(e.x,e.y)],r=[[],[]],o=[],n=[{},{}],h=[{},{}],a=[[],[]],c=`${t.x}:${t.y}`,l=`${e.x}:${e.y}`;for(n[0][c]=0,n[1][l]=0,r=[[i.get(t.x,t.y)],[i.get(e.x,e.y)]];r[0].length>0&&r[1].length>0;){if(o.push(s[0],s[1]),s=[r[0].pop(),r[1].pop()],void 0!==h[0][s[1].coord]||void 0!==h[1][s[0].coord]){let t=Number(void 0!==h[0][s[1].coord]),e=[],n=[],a={x:s[t].x,y:s[t].y};for(;s[t];)e.push({x:s[t].x,y:s[t].y}),s[t]=h[1-t][s[t].coord];for(s[1-t]=i.get(a.x,a.y);s[1-t];)n.push({x:s[1-t].x,y:s[1-t].y}),s[1-t]=h[t][s[1-t].coord];e.reverse(),e.push(...n);let c=[];return c.push(...r[0]),c.push(...r[1]),{path:e,nodes:[],open:c,closed:o,length:0}}a=[this.getNeighbours(s[0],l,i),this.getNeighbours(s[1],c,i)],a.forEach((t,e)=>{t.forEach(t=>{let i=t[0],o=n[e][s[e].coord]+i.movementCost+(t[1]>3?this.diagonalCost-1:0);(void 0===n[e][i.coord]||o<n[e][i.coord])&&(n[e][i.coord]=o,h[e][i.coord]=s[e],r[e].insertSorted(i,(t,i)=>n[e][i.coord]-n[e][t.coord]))})})}let u=[];return u.push(...r[0]),u.push(...r[1]),{path:[],nodes:[],open:u,closed:o,length:0}}getNeighbours(t,e,i){let s=[],r=[[1,0],[0,1],[-1,0],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]];for(let o=0;o<(this.diagonal?8:4);o++){if(t.x+r[o][0]>i.width-1||t.x+r[o][0]<0)continue;if(t.y+r[o][1]>i.height-1||t.y+r[o][1]<0)continue;if(!this.passDiagonal&&o>3&&i.get(t.x+r[o][0],t.y).solid&&i.get(t.x,t.y+r[o][1]).solid)continue;let n=i.get(t.x+r[o][0],t.y+r[o][1]);n.solid&&n.coord!==e||s.push([n,o])}return s}},Array.prototype.insertSorted=function(t,e){if(this.length<1||e(t,this[this.length-1])>=0)return this.push(t),this;for(var i=this.length-2;i>=0;i--)if(e(t,this[i])>=0)return this.splice(i+1,0,t),this;return this.splice(0,0,t),this}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),r=i(1),o=i(5);e.MeshGrid=class{constructor(t,e){this.map={},this.meshes=t,this.convexHull=e}get(t){return this.map[t.coord]}generateMap(){this.map={};let t=[];this.meshes.forEach(e=>{t.push(...e.vertices),t.push(e.center)}),t.push(...this.convexHull);let e=this.BowyerWatson(t);for(let t=0;t<e.length;t++){let i=e[t];for(let s=0;s<this.meshes.length;s++)this.meshes[s].overlap(i)&&(e.splice(t,1),t--)}return e.forEach(t=>{t.vertices.forEach(e=>{let i=[],o=t.sidePoints.sort((t,i)=>new s.Point(t.x-e.x,t.y-e.y).length-new s.Point(i.x-e.x,i.y-e.y).length);i.push(new r.Graph(o[0].x,o[0].y,!1,o[0].distance(e))),i.push(new r.Graph(o[1].x,o[1].y,!1,o[1].distance(e))),i.push(new r.Graph(o[2].x,o[2].y,!1,o[2].distance(e)));let n=t.vertices.sort((t,i)=>new s.Point(t.x-e.x,t.y-e.y).length-new s.Point(i.x-e.x,i.y-e.y).length);i.push(new r.Graph(n[0].x,n[0].y,!1,n[0].distance(e))),i.push(new r.Graph(n[1].x,n[1].y,!1,n[1].distance(e))),i.push(new r.Graph(n[2].x,n[2].y,!1,n[2].distance(e))),void 0===this.map[e.coord]?this.map[e.coord]={node:e,neighbours:[...i]}:this.map[e.coord].neighbours.push(...i)}),t.sidePoints.forEach(e=>{let i=[],o=t.vertices.sort((t,i)=>new s.Point(t.x-e.x,t.y-e.y).length-new s.Point(i.x-e.x,i.y-e.y).length);i.push(new r.Graph(o[0].x,o[0].y,!1,o[0].distance(e))),i.push(new r.Graph(o[1].x,o[1].y,!1,o[1].distance(e))),i.push(new r.Graph(o[2].x,o[2].y,!1,o[2].distance(e)));let n=t.sidePoints.sort((t,i)=>new s.Point(t.x-e.x,t.y-e.y).length-new s.Point(i.x-e.x,i.y-e.y).length);i.push(new r.Graph(n[0].x,n[0].y,!1,n[0].distance(e))),i.push(new r.Graph(n[1].x,n[1].y,!1,n[1].distance(e))),i.push(new r.Graph(n[2].x,n[2].y,!1,n[2].distance(e))),void 0===this.map[e.coord]?this.map[e.coord]={node:e,neighbours:[...i]}:this.map[e.coord].neighbours.push(...i)})}),Object.keys(this.map).forEach(t=>{let e=[];this.map[t].neighbours=this.map[t].neighbours.filter(t=>{for(let i=0;i<e.length;i++)if(e[i]===t.coord)return!1;return e.push(t.coord),!0})}),t.length=0,this.meshes.forEach(t=>{t.vertices.forEach((e,i)=>{let s=t.neigbourVertices(i);void 0===this.map[e.coord]&&(this.map[e.coord]={neighbours:[],node:e});let o=this.map[e.coord].neighbours.map(t=>t.coord);s.forEach(t=>{if(!o.includes(t.coord)){let i=new r.Graph(t.x,t.y,!1,e.distance(t));this.map[e.coord].neighbours.push(i)}})})}),Object.keys(this.map).forEach((e,i)=>{t.push(this.map[e].node)}),{triangulation:e,points:t}}BowyerWatson(t){let e=[],i=this.smallestTriangle;e.push(i),t.forEach((t,i)=>{let s=[];e.forEach(e=>{e.insideCircumcircle(t)&&s.push(e)});let r=[];s.forEach((t,e)=>{t.edges.forEach(t=>{for(let i=0;i<s.length;i++)if(i!=e&&s[i].containsEdge(t))return;r.push(t)})});for(let t=0;t<s.length;t++){let i=s[t];for(let t=0;t<e.length;t++){e[t].equals(i)&&(e.splice(t,1),t--)}}r.forEach(i=>{let s=new o.Triangle([t,i.p1,i.p2]);e.push(s)})});let s=i.vertices[0],r=i.vertices[1],n=i.vertices[2];for(let t=0;t<e.length;t++){let i=e[t];for(let o=0;o<3;o++){let h=i.vertices[o];if(h.x==s.x&&h.y==s.y||h.x==r.x&&h.y==r.y||h.x==n.x&&h.y==n.y){e.splice(t,1),t--;break}}}return e}get smallestTriangle(){let t=[];t.push(...this.convexHull);t.sort((t,e)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))[0];let e=t.sort((t,e)=>t.y-e.y)[0],i=t.sort((t,e)=>e.y-t.y)[0],r=t.sort((t,e)=>e.x-t.x)[0],n=new s.Point(0,0),h=new s.Point(2*r.x,e.y),a=new s.Point(n.x,2*i.y);return new o.Triangle([n,h,a])}}},function(t,e,i){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),s(i(6)),s(i(5))}]);